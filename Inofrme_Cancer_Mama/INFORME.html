<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gonzalo Mesas Aranda">

<title>Aprendizaje Computacional</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Entrega_Final_files/libs/clipboard/clipboard.min.js"></script>
<script src="Entrega_Final_files/libs/quarto-html/quarto.js"></script>
<script src="Entrega_Final_files/libs/quarto-html/popper.min.js"></script>
<script src="Entrega_Final_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Entrega_Final_files/libs/quarto-html/anchor.min.js"></script>
<link href="Entrega_Final_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Entrega_Final_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="Entrega_Final_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="Entrega_Final_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Entrega_Final_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Entrega_Final_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="Entrega_Final_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">

<script src="Entrega_Final_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="Entrega_Final_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul>
  <li><a href="#abstact" id="toc-abstact" class="nav-link active" data-scroll-target="#abstact"><span class="header-section-number">1</span> Abstact</a></li>
  <li><a href="#flujo-de-trabajo" id="toc-flujo-de-trabajo" class="nav-link" data-scroll-target="#flujo-de-trabajo"><span class="header-section-number">2</span> Flujo de trabajo</a></li>
  <li><a href="#preprocesamiento" id="toc-preprocesamiento" class="nav-link" data-scroll-target="#preprocesamiento"><span class="header-section-number">3</span> Preprocesamiento</a></li>
  <li><a href="#estadística-descriptiva" id="toc-estadística-descriptiva" class="nav-link" data-scroll-target="#estadística-descriptiva"><span class="header-section-number">4</span> Estadística descriptiva</a>
  <ul class="collapse">
  <li><a href="#variables-categóricas" id="toc-variables-categóricas" class="nav-link" data-scroll-target="#variables-categóricas"><span class="header-section-number">4.1</span> Variables categóricas</a></li>
  <li><a href="#variables-numéricas" id="toc-variables-numéricas" class="nav-link" data-scroll-target="#variables-numéricas"><span class="header-section-number">4.2</span> Variables numéricas</a></li>
  </ul></li>
  <li><a href="#análisis-de-asociación" id="toc-análisis-de-asociación" class="nav-link" data-scroll-target="#análisis-de-asociación"><span class="header-section-number">5</span> Análisis de asociación</a></li>
  <li><a href="#análisis-multivariante" id="toc-análisis-multivariante" class="nav-link" data-scroll-target="#análisis-multivariante"><span class="header-section-number">6</span> Análisis multivariante</a>
  <ul class="collapse">
  <li><a href="#modelo-con-todas-las-variables" id="toc-modelo-con-todas-las-variables" class="nav-link" data-scroll-target="#modelo-con-todas-las-variables"><span class="header-section-number">6.1</span> Modelo con todas las variables</a></li>
  <li><a href="#modelo-con-las-variables-filtradas" id="toc-modelo-con-las-variables-filtradas" class="nav-link" data-scroll-target="#modelo-con-las-variables-filtradas"><span class="header-section-number">6.2</span> Modelo con las variables filtradas</a></li>
  <li><a href="#modelo-usando-stepaic" id="toc-modelo-usando-stepaic" class="nav-link" data-scroll-target="#modelo-usando-stepaic"><span class="header-section-number">6.3</span> Modelo usando stepAIC</a></li>
  <li><a href="#tabla-resumen" id="toc-tabla-resumen" class="nav-link" data-scroll-target="#tabla-resumen"><span class="header-section-number">6.4</span> Tabla resumen</a></li>
  </ul></li>
  <li><a href="#modelos-predictivos" id="toc-modelos-predictivos" class="nav-link" data-scroll-target="#modelos-predictivos"><span class="header-section-number">7</span> Modelos predictivos</a>
  <ul class="collapse">
  <li><a href="#marco-teórico" id="toc-marco-teórico" class="nav-link" data-scroll-target="#marco-teórico"><span class="header-section-number">7.1</span> Marco teórico</a>
  <ul class="collapse">
  <li><a href="#doble-validación-cruzada" id="toc-doble-validación-cruzada" class="nav-link" data-scroll-target="#doble-validación-cruzada"><span class="header-section-number">7.1.1</span> Doble validación cruzada</a></li>
  </ul></li>
  <li><a href="#métodos-de-filtrado" id="toc-métodos-de-filtrado" class="nav-link" data-scroll-target="#métodos-de-filtrado"><span class="header-section-number">7.2</span> Métodos de filtrado</a></li>
  <li><a href="#métodos-wrapper" id="toc-métodos-wrapper" class="nav-link" data-scroll-target="#métodos-wrapper"><span class="header-section-number">7.3</span> Métodos wrapper</a></li>
  <li><a href="#métodos-embedded" id="toc-métodos-embedded" class="nav-link" data-scroll-target="#métodos-embedded"><span class="header-section-number">7.4</span> Métodos embedded</a></li>
  </ul></li>
  <li><a href="#generación-de-métricas" id="toc-generación-de-métricas" class="nav-link" data-scroll-target="#generación-de-métricas"><span class="header-section-number">8</span> Generación de métricas</a>
  <ul class="collapse">
  <li><a href="#redes-neuronales" id="toc-redes-neuronales" class="nav-link" data-scroll-target="#redes-neuronales"><span class="header-section-number">8.1</span> Redes Neuronales</a>
  <ul class="collapse">
  <li><a href="#método-de-filtrado" id="toc-método-de-filtrado" class="nav-link" data-scroll-target="#método-de-filtrado"><span class="header-section-number">8.1.1</span> Método de filtrado</a></li>
  <li><a href="#método-wrapper" id="toc-método-wrapper" class="nav-link" data-scroll-target="#método-wrapper"><span class="header-section-number">8.1.2</span> Método wrapper</a></li>
  <li><a href="#método-embedded" id="toc-método-embedded" class="nav-link" data-scroll-target="#método-embedded"><span class="header-section-number">8.1.3</span> Método embedded</a></li>
  </ul></li>
  <li><a href="#máquinas-de-soporte-vectorial-svm" id="toc-máquinas-de-soporte-vectorial-svm" class="nav-link" data-scroll-target="#máquinas-de-soporte-vectorial-svm"><span class="header-section-number">8.2</span> Máquinas de soporte vectorial (SVM)</a>
  <ul class="collapse">
  <li><a href="#método-de-filtrado-1" id="toc-método-de-filtrado-1" class="nav-link" data-scroll-target="#método-de-filtrado-1"><span class="header-section-number">8.2.1</span> Método de filtrado</a></li>
  <li><a href="#método-wrapper-1" id="toc-método-wrapper-1" class="nav-link" data-scroll-target="#método-wrapper-1"><span class="header-section-number">8.2.2</span> Método wrapper</a></li>
  <li><a href="#método-embedded-1" id="toc-método-embedded-1" class="nav-link" data-scroll-target="#método-embedded-1"><span class="header-section-number">8.2.3</span> Método embedded</a></li>
  </ul></li>
  <li><a href="#árbol-de-decisión" id="toc-árbol-de-decisión" class="nav-link" data-scroll-target="#árbol-de-decisión"><span class="header-section-number">8.3</span> Árbol de decisión</a>
  <ul class="collapse">
  <li><a href="#método-de-filtrado-2" id="toc-método-de-filtrado-2" class="nav-link" data-scroll-target="#método-de-filtrado-2"><span class="header-section-number">8.3.1</span> Método de filtrado</a></li>
  <li><a href="#método-wrapper-2" id="toc-método-wrapper-2" class="nav-link" data-scroll-target="#método-wrapper-2"><span class="header-section-number">8.3.2</span> Método wrapper</a></li>
  <li><a href="#método-embedded-2" id="toc-método-embedded-2" class="nav-link" data-scroll-target="#método-embedded-2"><span class="header-section-number">8.3.3</span> Método embedded</a></li>
  </ul></li>
  <li><a href="#knn-vecinos-más-cercanos" id="toc-knn-vecinos-más-cercanos" class="nav-link" data-scroll-target="#knn-vecinos-más-cercanos"><span class="header-section-number">8.4</span> KNN (Vecinos más cercanos)</a>
  <ul class="collapse">
  <li><a href="#método-de-filtrado-3" id="toc-método-de-filtrado-3" class="nav-link" data-scroll-target="#método-de-filtrado-3"><span class="header-section-number">8.4.1</span> Método de filtrado</a></li>
  <li><a href="#método-wrapper-3" id="toc-método-wrapper-3" class="nav-link" data-scroll-target="#método-wrapper-3"><span class="header-section-number">8.4.2</span> Método wrapper</a></li>
  <li><a href="#método-embedded-3" id="toc-método-embedded-3" class="nav-link" data-scroll-target="#método-embedded-3"><span class="header-section-number">8.4.3</span> Método embedded</a></li>
  </ul></li>
  <li><a href="#naive-bayes" id="toc-naive-bayes" class="nav-link" data-scroll-target="#naive-bayes"><span class="header-section-number">8.5</span> Naive Bayes</a>
  <ul class="collapse">
  <li><a href="#método-de-filtrado-4" id="toc-método-de-filtrado-4" class="nav-link" data-scroll-target="#método-de-filtrado-4"><span class="header-section-number">8.5.1</span> Método de filtrado</a></li>
  <li><a href="#método-wrapper-4" id="toc-método-wrapper-4" class="nav-link" data-scroll-target="#método-wrapper-4"><span class="header-section-number">8.5.2</span> Método wrapper</a></li>
  <li><a href="#método-embedded-4" id="toc-método-embedded-4" class="nav-link" data-scroll-target="#método-embedded-4"><span class="header-section-number">8.5.3</span> Método embedded</a></li>
  </ul></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest"><span class="header-section-number">8.6</span> Random forest</a>
  <ul class="collapse">
  <li><a href="#método-de-filtrado-5" id="toc-método-de-filtrado-5" class="nav-link" data-scroll-target="#método-de-filtrado-5"><span class="header-section-number">8.6.1</span> Método de filtrado</a></li>
  <li><a href="#método-wrapper-5" id="toc-método-wrapper-5" class="nav-link" data-scroll-target="#método-wrapper-5"><span class="header-section-number">8.6.2</span> Método wrapper</a></li>
  <li><a href="#método-embedded-5" id="toc-método-embedded-5" class="nav-link" data-scroll-target="#método-embedded-5"><span class="header-section-number">8.6.3</span> Método embedded</a></li>
  </ul></li>
  <li><a href="#adaboost" id="toc-adaboost" class="nav-link" data-scroll-target="#adaboost"><span class="header-section-number">8.7</span> Adaboost</a>
  <ul class="collapse">
  <li><a href="#filtrado" id="toc-filtrado" class="nav-link" data-scroll-target="#filtrado"><span class="header-section-number">8.7.1</span> Filtrado</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#comparación-de-los-métodos-de-selección-de-variables" id="toc-comparación-de-los-métodos-de-selección-de-variables" class="nav-link" data-scroll-target="#comparación-de-los-métodos-de-selección-de-variables"><span class="header-section-number">9</span> Comparación de los métodos de selección de variables</a></li>
  <li><a href="#modelo-final" id="toc-modelo-final" class="nav-link" data-scroll-target="#modelo-final"><span class="header-section-number">10</span> Modelo final</a></li>
  <li><a href="#shiny-app" id="toc-shiny-app" class="nav-link" data-scroll-target="#shiny-app"><span class="header-section-number">11</span> Shiny APP</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Aprendizaje Computacional</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Expand Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Gonzalo Mesas Aranda </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="abstact" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Abstact</h1>
<p>En este proyecto se ha estudiado un conjunto de datos de pacientes con cáncer de mama desde diferentes acercamientos. Primero se ha realizado un análisis estadístico de los datos, imprescindible en este tipo de estudios, donde se ha obtenido información valiosa y explicativa de la variable de estudio. Posteriormente se han analizado diferentes modelos predictivos usando una estimación robusta de los parámetros y métricas, de donde se ha podido concluir el ANN como mejor modelo por su robustez y excelente rendimiento. Por último se ha lanzado el modelo final en una aplicación Shiny para su uso en un entorno real.</p>
<p>Para más información sobre el código, visitar mi repositorio de <a href="https://github.com/GonzaloM786/Funciones-para-analisis-estadisticos-en-R">GitHub</a>.</p>
</section>
<section id="flujo-de-trabajo" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Flujo de trabajo</h1>
<p><img src="flujo.png" alt="Flujo de trabajo" style="width: 95%; height: auto;"></p>
</section>
<section id="preprocesamiento" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Preprocesamiento</h1>
<p>El preprocesamiento es un paso esencial en el análisis de datos. No simplemente se normalizan y limpian los datos sino que también se llevan a cabo transformaciones que incluso afecta al rendimiento final de los modelos predictivos. A continuación se describirán las diferentes variables del conjunto de datos y se detallarán los cambios a los que han sido sometidas, si los hay.</p>
<ul>
<li><strong>Edad al diagnóstico</strong>: edad del paciente en el momento en que se le diagnosticó cáncer de mama.</li>
<li><strong>Fecha al diagnóstico</strong>: fecha en que se diagnosticó cáncer de mama. Se ha estratificado por décadas.</li>
<li><strong>Estado menopáusico</strong>: indica si la paciente es premenopáusica o postmenopáusica.</li>
<li><strong>Tipo de cirugía</strong>: tipo de intervención quirúrgica realizada.</li>
<li><strong>Histología</strong>: tipo de tejido del tumor y su apariencia microscópica. Más adelante se comentará la decisión final sobre esta variable.</li>
<li><strong>Tamaño</strong>: tamaño del tumor.</li>
<li><strong>Grado</strong>: comparación de las células tumorales bajo el microscopio en comparación con las células normales.</li>
<li><strong>RE</strong>: receptores de estrógeno en las células tumorales.</li>
<li><strong>RP</strong>: receptores de progesterona en las células tumorales.</li>
<li><strong>Her2</strong>: sobreexpresión del gen HER2.</li>
<li><strong>ki67</strong>: marcador de proliferación celular que indica la rapidez con la que crecen las células cancerosas.</li>
<li><strong>Fenotipo_IHQ</strong>: clasificación del tumor basada en la expresión de ciertos marcadores inmunohistoquímicos.</li>
<li><strong>Ganglios</strong>: número de ganglios linfáticos afectados por el cáncer. En función del número se han agrupado en cuatro categorías según la gravedad.</li>
<li><strong>Estadio</strong>: clasificación del cáncer en etapas, según el tamaño del tumor, afectación de ganglios y presencia de metástasis. Se han agrupado las distintas categorías en valores entre I y IV.</li>
<li><strong>Estado actual</strong>: estado vital actual del paciente, puede ser fallecido o vivo. Se ha simplificado a variable binaria, agrupando los distintos tipos de fallecimiento y pacientes vivos.</li>
</ul>
<p>Para todas las variables, los datos faltantes han sido imputados con la <strong>media</strong> y la <strong>moda</strong> para las variables numéricas y categóricas respectivamente. Además, todas las variables numéricas han sido estandarizadas, es decir que sus medias son cero y desviaciones estándar uno.</p>
</section>
<section id="estadística-descriptiva" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Estadística descriptiva</h1>
<p>La estadística descriptiva proporciona una visión general de la distribución y comportamiento de los datos. Es importante en este contexto, ya que ayuda a identificar valores atípicos o clases desbalanceadas. Aquí las distribuciones de las variables del modelo.</p>
<section id="variables-categóricas" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="variables-categóricas"><span class="header-section-number">4.1</span> Variables categóricas</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">F.DIAG</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">MENOP</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">CIRUGIA</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">HISTOLOGIA</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false" href="">GRADO</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false" href="">HER2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false" href="">FENOTIPO</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false" href="">GANGLIOS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-9" role="tab" aria-controls="tabset-1-9" aria-selected="false" href="">ESTADIO</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-10" role="tab" aria-controls="tabset-1-10" aria-selected="false" href="">ESTADO_ACTUAL</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-9-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-10-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Se pueden observar las frecuencias absolutas de las distintas variables, de las cuales hay algunas que están relativamente <strong>desbalanceadas</strong>. Cabe destacar la variable de estudio <code>ESTADO_ACTUAL</code>, donde el 95.2% de los datos pertenecen a la clase “viva”, lo cual va suponer una dificultad en el entrenamiento de algunos modelos predictivos, ya que puede ocurrir que estos se decanten por la clasificación mayoritaria simplemente por el hecho de serlo. Además, en la variable <code>HISTOLOGIA</code> existen 324 valores faltantes, además de que el resto de las clases tienen una frecuencia muy reducida salvo DUCTAL. Por esta razón, a pesar de ser una variable potencialmente importante y significativa, las condiciones van a producir problemas como la introducción de ruido, complejidad y errores en los distintos algoritmos de ajuste de los modelos, por lo que <strong>se eliminará</strong> del estudio.</p>
</section>
<section id="variables-numéricas" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="variables-numéricas"><span class="header-section-number">4.2</span> Variables numéricas</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">EDAD_DCO</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">TAM</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">RE</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false" href="">RP</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false" href="">KI67</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Estas distribuciones se han obtenido sobre el conjunto de datos sin estandarizar para mayor interpretabilidad, aunque se usará el su versión estandarizada para el resto del estudio y todos los cálculos.</p>
<p>Los pacientes tienen una media de edad de 57 años y las distribuciones suelen estar concentradas cerca de la media, salvo en <code>RE</code> y <code>RP</code>, donde sobre todo en <code>RP</code> se distinguen dos claros grupos.</p>
</section>
</section>
<section id="análisis-de-asociación" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Análisis de asociación</h1>
<p>La siguiente figura muestra los resultados de la estadística bivariable, es decir el <strong>p-valor</strong> resultante del test correspondiente a cada par de variables. En verde se muestran aquellas con un p-valor por debajo de 0.05, es decir, las diferencias en sus distribuciones muy probablemente no sean fruto del azar.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La información más destacable son las variables relacionadas con la variable de estudio, las cuales son: <strong>ESTADIO, F.DIAG, RE y TAM</strong>. Aunque no haya relación directa con el grado de explicabilidad de las mismas respecto a la variable de estudio o su eficacia en modelos predictivos, estas variables son potencialmente importantes en este estudio, por lo que se tendrán en cuenta para el modelo explicativo y se usarán en los métodos de filtrado.</p>
</section>
<section id="análisis-multivariante" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Análisis multivariante</h1>
<p>El objetivo del análisis multivariante es estudiar si hay alguna combinación de variables donde haya alguna variable/s que expliquen con una buena confianza la variable de estudio. Para ello se probará la regresión logística con tres conjuntos de variables distintas. Al final se proporciona una tabla resumen con los resultados.</p>
<section id="modelo-con-todas-las-variables" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="modelo-con-todas-las-variables"><span class="header-section-number">6.1</span> Modelo con todas las variables</h2>
<p>Se comprobará el comportamiento del modelo explicativo con todas las variables. Solo cuatro variables de todo el modelo tienen un p-valor menor a 0.05, las cuales son en las que se puede confiar para explicar la variable de estudio. Esta afirmación esta basada en que el p-valor representa la probabilidad de observar un z-value (estimate entre error estándar) tan extremo como el observado.</p>
<p>Se puede deducir en función del estimate de las variables que cumplen esta condición, si influyen positivamente o negativamente al evento de estudio mirando el signo de este. Por ejemplo, <strong>a más edad, estadio</strong> y si la paciente es <strong>premenopáusica</strong>, hay <strong>más probabilidades</strong> de que el evento sea “fallecido”; mientras que si el diagnóstico se produjo en la década de los 2010s, hay menos probabilidades, lo cual parece ser coherente.</p>
<details>
<summary>
Mostrar/Ocultar Resumen del Modelo
</summary>
<pre> 
Call:
glm(formula = ESTADO_ACTUAL == 1 ~ ., family = binomial("logit"), 
    data = df)

Coefficients: (1 not defined because of singularities)
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             -1.53834    2.36443  -0.651 0.515292    
EDAD_DCO                 1.37237    0.53021   2.588 0.009644 ** 
F.DIAG201               -5.09741    1.00795  -5.057 4.25e-07 ***
MENOPPREMENOPAUSICA      2.11134    1.05608   1.999 0.045584 *  
CIRUGIARADICAL           0.69982    0.68951   1.015 0.310125    
TAM                     -0.16569    0.40524  -0.409 0.682645    
GRADOII                 -0.56035    0.90957  -0.616 0.537854    
GRADOIII                -0.34745    0.97221  -0.357 0.720805    
RE                       0.41797    0.88154   0.474 0.635406    
RP                      -0.20255    0.45427  -0.446 0.655681    
HER2P                   -1.30621    1.51746  -0.861 0.389357    
KI67                     0.05944    0.40250   0.148 0.882592    
FENOTIPOLUMINAL A       -1.48336    2.43230  -0.610 0.541956    
FENOTIPOLUMINAL B       -2.02779    2.13689  -0.949 0.342648    
FENOTIPOLUMINAL HER2    -0.34369    2.65555  -0.129 0.897021    
FENOTIPOLUMINAL ND      -2.53037    2.39570  -1.056 0.290871    
FENOTIPOTRIPLE NEGATIVO       NA         NA      NA       NA    
GANGLIOSMODERADO        -1.62857    1.26307  -1.289 0.197267    
GANGLIOSNINGUNO         -0.69683    0.72799  -0.957 0.338464    
GANGLIOSSEVERO          -1.99376    1.58676  -1.257 0.208934    
ESTADIOII                1.44050    0.95561   1.507 0.131705    
ESTADIOIII               3.60441    1.41271   2.551 0.010729 *  
ESTADIOIV                4.55408    1.33213   3.419 0.000629 ***

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 192.58  on 499  degrees of freedom
Residual deviance: 101.50  on 478  degrees of freedom
AIC: 145.5

Number of Fisher Scoring iterations: 8
 </pre>
</details>
</section>
<section id="modelo-con-las-variables-filtradas" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="modelo-con-las-variables-filtradas"><span class="header-section-number">6.2</span> Modelo con las variables filtradas</h2>
<p>Para este modelo se usarán las variables que obtuvieron un p-valor menor a 0.05 en el análisis bivariable respecto a la variable de estudio: <strong>ESTADIO, F.DIAG, RE y TAM</strong>. Se puede observar el mismo patrón que antes para las variables <code>ESTADIO</code> y <code>F.DIAG</code>.</p>
<details>
<summary>
Mostrar/Ocultar Resumen del Modelo
</summary>
<pre> 
Call:
glm(formula = ESTADO_ACTUAL == 1 ~ ESTADIO + F.DIAG + RE + TAM, 
    family = binomial("logit"), data = df)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -2.9912     0.7310  -4.092 4.28e-05 ***
ESTADIOII     1.3632     0.8114   1.680 0.092940 .  
ESTADIOIII    2.2471     0.8730   2.574 0.010055 *  
ESTADIOIV     3.6180     1.0753   3.365 0.000766 ***
F.DIAG201    -4.2108     0.8603  -4.894 9.86e-07 ***
RE           -0.1270     0.2314  -0.549 0.582939    
TAM           0.2741     0.1777   1.542 0.123058    
---

Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 192.58  on 499  degrees of freedom
Residual deviance: 120.84  on 493  degrees of freedom
AIC: 134.84

Number of Fisher Scoring iterations: 8
 </pre>
</details>
</section>
<section id="modelo-usando-stepaic" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="modelo-usando-stepaic"><span class="header-section-number">6.3</span> Modelo usando stepAIC</h2>
<p>En este último modelo, se comenzará con todas las variables y se eliminarán de acuerdo con el método de selección de variables “stepAIC backward”. Las variables seleccionadas son todas significativas y se corresponden con las que tuvieron un p-valor menor a 0.05 en el modelo con todas las variables. Se pueden observar los mismos patrones de influencia en la variable de estudio.</p>
<details>
<summary>
Mostrar/Ocultar Resumen del Modelo
</summary>
<pre> 
Call:
glm(formula = ESTADO_ACTUAL == 1 ~ EDAD_DCO + F.DIAG + MENOP + 
    ESTADIO, family = binomial("logit"), data = df)

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          -4.0367     0.8594  -4.697 2.64e-06 ***
EDAD_DCO              1.4627     0.4424   3.306 0.000945 ***
F.DIAG201            -4.6081     0.8761  -5.260 1.44e-07 ***
MENOPPREMENOPAUSICA   1.8711     0.8956   2.089 0.036694 *  
ESTADIOII             1.7504     0.8306   2.108 0.035073 *  
ESTADIOIII            2.8728     0.8951   3.209 0.001330 ** 
ESTADIOIV             3.6964     1.1170   3.309 0.000936 ***

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 192.58  on 499  degrees of freedom
Residual deviance: 109.29  on 493  degrees of freedom
AIC: 123.29

Number of Fisher Scoring iterations: 8
 </pre>
</details>
</section>
<section id="tabla-resumen" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="tabla-resumen"><span class="header-section-number">6.4</span> Tabla resumen</h2>
<div class="cell">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Campo</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Todas las variables</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Variables filtradas</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">StepAIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Variables significativas</td>
<td style="text-align: left; width: 20em;">EDAD_DCO ** F.DIAG201 *** MENOPPREMENOPAUSICA * ESTADIOIII * ESTADIOIV ***</td>
<td style="text-align: left;">ESTADIOIII * ESTADIOIV *** F.DIAG201 ***</td>
<td style="text-align: left;">EDAD_DCO *** F.DIAG201 *** MENOPPREMENOPAUSICA * ESTADIOII * ESTADIOIII ** ESTADIOIV ***</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Null deviance</td>
<td style="text-align: left; width: 20em;">192.58</td>
<td style="text-align: left;">192.58</td>
<td style="text-align: left;">192.58</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Residual deviance</td>
<td style="text-align: left; width: 20em;">101.5</td>
<td style="text-align: left;">120.84</td>
<td style="text-align: left;">109.29</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">AIC</td>
<td style="text-align: left; width: 20em;">145.5</td>
<td style="text-align: left;">134.84</td>
<td style="text-align: left;">123.29</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Las conclusiones que se pueden sacar del modelo explicativo son que la edad y estadío aumentan el riesgo de muerte, mientras que una fecha de diagnóstico más tardía lo reduce, lo cual es trivial. Además, lo más interesante puede ser que la condición premenopáusica aumenta el riesgo de muerte. Esto no implica que haya causalidad entre ambas variables, pero sí una correlación, por lo que no por ser premenopáusica (más jóven en general) se tiene mayor riesgo, sino que este conjunto de pacientes tienen unas condiciones más agresivas en general (estadío más avanzado, más ganlios afectados, etc.). Este dato es objeto de un estudio más profundo y debe ser interpretado por un porfesional de la salud.</p>
</section>
</section>
<section id="modelos-predictivos" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Modelos predictivos</h1>
<p>En este apartado se analizarán los resultados de diferentes modelos predictivos usando una evaluación honesta con el <strong>5x2 Double Cross Validation</strong>. Se usarán para cada modelo, tres métodos de selección de variables: filtrado (p-vlor menor a 0.05 en el análisis bivariable), wrapper (stepAUC backward) y embedded (modelo lasso). Se usará el AUC como métrica para elegir el mejor modelo.</p>
<p>Todas las funciones creadas que implementan la doble validación cruzada, toman una lista con los rangos de los hiperparámetros que se van a probar. Para ello, primeramente se debe hacer un análisis exploratorio, donde se prueba el modelo midiendo las métricas aparentes, en este caso el <strong>AUC</strong> ya que es una métrica independiente al umbral y engloba otras. Además, en un entorno clínico como este, es común usar esta métrica por su familiaridad por parte del personal sanitario.</p>
<p>En el análisis exploratorio, se acotan entonces los rangos de búsqueda de hiperparámetros. Después se puede proceder con la doble validación cruzada, de donde se obtendrán métricas robustas y honestas. Además se repite esta para cinco valores distintos de semillas, con el objetivo de no depender tanto de la misma.</p>
<section id="marco-teórico" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="marco-teórico"><span class="header-section-number">7.1</span> Marco teórico</h2>
<section id="doble-validación-cruzada" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="doble-validación-cruzada"><span class="header-section-number">7.1.1</span> Doble validación cruzada</h3>
<p>La doble validación cruzada es una técnica de validación interna que tiene como objetivo proporcionar una evaluación robusta del rendimiento del modelo. Además es comúnmente usada para el ajuste de hiperparámetros. Concretamente, en este informe se usará una disposición 5x2, lo cual se refiere al número de folds externos e internos respectivamente. A continuación se muestra un esquema representativo:</p>
<p><img src="crossValidation.png" alt="Esquema del Double Cross Validation" style="width: 95%; height: auto;"></p>
<p>La idea principal es que los cinco folds de test, se reservan para calcular las métricas honestas del modelo, sin que estos datos hayan servido para entrenar o validar el mismo. El resto de los datos que no son de test, se dividen en dos y se usan para entrenamiento y validación, donde se realizará la búsqueda de los mejores parámetros.</p>
</section>
</section>
<section id="métodos-de-filtrado" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="métodos-de-filtrado"><span class="header-section-number">7.2</span> Métodos de filtrado</h2>
<p>Estos métodos de selección de variables se basan en estadísticas de los datos, sin tener en cuenta ninguna métrica o modelo de Machine Learning. Primeramente se seleccionan las variables, que en este caso se han elegido las que mantienen un p-valor menor a 0.05 en el resultado del test estadístico respecto a la variable de estudio. Después se procede con el método de validación interna, manteniendo estas variables fijas. Las variables seleccionadas por este criterio son: <strong>ESTADIO, F.DIAG, RE y TAM</strong>, las cuales son las que se usarán siempre que se use este método.</p>
</section>
<section id="métodos-wrapper" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="métodos-wrapper"><span class="header-section-number">7.3</span> Métodos wrapper</h2>
<p>A diferencia de los de filtrado, estos sí que se basan en el rendimiento del modelo. Se basan en la elección de variables que optimicen una métrica concreta. Hay de distintos tipos, pero aquí se usa el <strong>Backward Elimination</strong>, el cual parte de todas las variables y va eliminando aquellas que aumenten más la métrica usada, hasta que no haya variable que la mejora al quitarla.</p>
</section>
<section id="métodos-embedded" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="métodos-embedded"><span class="header-section-number">7.4</span> Métodos embedded</h2>
<p>Los métodos embedded usan modelos que penalizan la importancia de las variables menos relevantes. Estos métodos seleccionan variables al mismo tiempo que ajustan los parámetros. Concretamente, se usará el <strong>modelo lasso</strong>, que penaliza la suma de los valores absolutos de los coeficientes, eliminando algunos completamente. Se usará el paquete <code>glmnet</code>, el cual para el modelo lasso necesita que las variables categóricas estén codificadas en formato one-hot-encoding.</p>
</section>
</section>
<section id="generación-de-métricas" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Generación de métricas</h1>
<p>Para cada uno de los modelos usados, se han obtenido métricas usando doble validación cruzada para los tres métodos de selección de variables (filtrado, wrapper y embedded). Por tanto, para cada modelo existen tres tablas de información, las cuales se discutirán más adelante.</p>
<p>Debido a la gran cantidad de tiempo de computo necesaria para la generación de todos estos datos, se han computado y guardado en ficheros RData, los cuales se usarán en este informe para su interpretación.</p>
<section id="redes-neuronales" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="redes-neuronales"><span class="header-section-number">8.1</span> Redes Neuronales</h2>
<p>Se utilizará el paquete <code>nnet</code> para estimar el modelo. Los parámetros que se ajustarán son los siguientes:</p>
<ul>
<li><strong>Size</strong>: indica el número de neuronas en la capa oculta.</li>
<li><strong>Decay</strong>: controla la tasa de regularización aplicada a los pesos. Se usa para prevenir el sobreajuste, de manera que cuanto mayor sea este parámetro, mayor es la penalización, lo que da lugar a modelos más generalizables.</li>
</ul>
<p>Con la exploración inicial de los parámetros del modelo, junto al uso de la doble validación cruzada con método de filtrado, debido a su bajo tiempo de ejecución, los parámetros han sido acotados en este rango:</p>
<ul>
<li><strong>Size</strong>: 15, 17, 20, 23</li>
<li><strong>Decay</strong>: 0.1, 0.3</li>
</ul>
<section id="método-de-filtrado" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="método-de-filtrado"><span class="header-section-number">8.1.1</span> Método de filtrado</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Size</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">Decay</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="método-wrapper" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="método-wrapper"><span class="header-section-number">8.1.2</span> Método wrapper</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Size</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href="">Decay</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false" href="">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="método-embedded" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="método-embedded"><span class="header-section-number">8.1.3</span> Método embedded</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Size</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href="">Decay</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false" href="">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>En términos de AUC, la red neuronal parece haber dado buenos resultados, estando la media más alta en 0.911, además de la robustez en la medida. Sobre el parámetro size, las distribuciones parecen inclinarse por un valor más bajo, entorno a las 16 neuronas. El parámetro decay, parece no ser robusto entre los distintos métodos de filtrado, aunque el rango de búsqueda ya estaba bastante acotado, por lo que no debería implicar un mayor problema.</p>
<p>En la selección de variables, <code>F.DIAG</code>, <code>ESTADIO</code> parecen ser las que más aparece y son más importantes. Además de estas, también existen otras importantes como <code>CIRUGIA</code>, <code>EDAD</code>, <code>MENOP</code> y <code>GANGLIOS</code>.</p>
</section>
</section>
<section id="máquinas-de-soporte-vectorial-svm" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="máquinas-de-soporte-vectorial-svm"><span class="header-section-number">8.2</span> Máquinas de soporte vectorial (SVM)</h2>
<p>Las máquinas de soporte vectorial son algoritmos que usan kernels para proyectar los datos de entrada en un espacio de características de mayor dimensión, donde son linealmente separables. El paquete usado con su implementación es <code>e1071</code>.</p>
<p>Hay tres hiperparámetros principales: kernel, coste y gamma. Sin embargo, gracias a la exploración inicial y el método de filtrado, se han acotado en gran medida los kernels posibles, siendo el mejor con diferencia el <strong>kernel radial</strong>. Además, se ha comprobado que el coste no afecta prácticamente al resultado, por lo que se ha fijado en 100.</p>
<ul>
<li><strong>Gamma</strong>: controla el radio de influencia de los puntos de entrenamiento. Un gamma alto hace que el radio disminuya y el modelo se ajuste muy de cerca a los puntos de entrenamiento, lo que puede producir un modelo más complejo y sobreajuste. El rango de exploración es: 0.002, 0.005 y 0.008.</li>
</ul>
<section id="método-de-filtrado-1" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="método-de-filtrado-1"><span class="header-section-number">8.2.1</span> Método de filtrado</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Gamma</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="método-wrapper-1" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="método-wrapper-1"><span class="header-section-number">8.2.2</span> Método wrapper</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Gamma</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false" href="">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="método-embedded-1" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="método-embedded-1"><span class="header-section-number">8.2.3</span> Método embedded</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Gamma</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false" href="">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>El AUC ha dado buenos resultados en términos de robustez y la media más alta es de 0.881. Sin embargo el hiperparámetro gamma no goza de esta robustez, aunque al estar el rango bastante acotado no debería ser problemático. En cuanto a las variables, las más comunes vuelven a ser <code>F.DIAG</code> y <code>ESTADIO</code>; además se encuentran <code>CIRUGIA</code>, <code>EDAD</code>, <code>MENOP</code>, <code>GANGLIOS</code>, <code>RP</code> y <code>KI67</code>.</p>
<p>En general ha resultado ser un modelo con una robustez decente y un conjunto de variables que se encuentran entre lo esperado.</p>
</section>
</section>
<section id="árbol-de-decisión" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="árbol-de-decisión"><span class="header-section-number">8.3</span> Árbol de decisión</h2>
<p>Los árboles de decisión dividen los datos en subconjuntos más pequeños basándose en los valores de las características, hasta que cada subconunto es homogéneo o contiene el mismo valor de resultado. Cada nodo en el árbol representa una característica, mientras que cada rama representa un valor de esa característica. El paquete usado es <code>rpart</code>. Hay un único hiperparámetro a ajustar:</p>
<ul>
<li><strong>Cp</strong>: nivel de poda del árbol. Un valor de 1 se corresponde con un árbol sin divisiones, y un valor de 0 con uno de profundidad máxima.</li>
</ul>
<p>El rango de búsqueda de parámetros ha sido ajustado a 0.01 y 0.005. No obstante y no debido a un error en el código, para los tres métodos y para todos los folds, el mejor valor es siempre 0.01, por lo que se limitará a la discusión del AUC y las variables. Esto se debe a que parece que hay un umbral en el hiperparámetro a partir del cual el AUC no mejora, el cual gracias a la exploración inicial, se ha determinado que es 0.01.</p>
<section id="método-de-filtrado-2" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="método-de-filtrado-2"><span class="header-section-number">8.3.1</span> Método de filtrado</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">AUC</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="método-wrapper-2" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="método-wrapper-2"><span class="header-section-number">8.3.2</span> Método wrapper</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="método-embedded-2" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="método-embedded-2"><span class="header-section-number">8.3.3</span> Método embedded</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Este modelo parece no haber dado tan buenos resultados de AUC, solamente en el método wrapper, donde además es robusto. El método embedded ha dado una media de 0.5 de AUC, lo cual es un resultado pésimo y al final del informe se comentará porque este método a veces no ha funcionado bien en el estudio.</p>
<p>Dadas estas condiciones, las variables, las cuales no son robustas entre los métodos, que se seleccionaría sería las elegidas en el método wrapper, las cuales son todas. A pesar de haber dado buenos resultados con este método, no ha resultado ser un modelo robusto, por lo que se recomendaría el uso de otros modelos.</p>
</section>
</section>
<section id="knn-vecinos-más-cercanos" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="knn-vecinos-más-cercanos"><span class="header-section-number">8.4</span> KNN (Vecinos más cercanos)</h2>
<p>Este algoritmo funciona identificando los k vecinos más cercanos a una nueva instancia, según una métrica de distancia. La clase mayoritaria entre esos puntos será la predicción. El paquete que lo implementa es <code>class</code> y con la opción <em>prob = true</em> se devuelve la probabilidad. El único parámetro a ajustar es el siguiente:</p>
<ul>
<li><strong>K</strong>: número de vecinos más cercanos. Ya que el problema es de clasificación binaria, se elegirán números impares para las pruebas, ya que elimina la posibilidad de empate.</li>
</ul>
<p>Una vez más, gracias a la exploración inicial y los métodos de filtrado, el espacio de búsqueda se ha reducido a: 23, 26, 29 y 32. Cabe destacar, que es necesario codificar con one-hot-encoding y escalar las variables numéricas para que el modelo pueda aceptar los datos.</p>
<section id="método-de-filtrado-3" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="método-de-filtrado-3"><span class="header-section-number">8.4.1</span> Método de filtrado</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href="">K</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="método-wrapper-3" class="level3" data-number="8.4.2">
<h3 data-number="8.4.2" class="anchored" data-anchor-id="método-wrapper-3"><span class="header-section-number">8.4.2</span> Método wrapper</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href="">K</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false" href="">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="método-embedded-3" class="level3" data-number="8.4.3">
<h3 data-number="8.4.3" class="anchored" data-anchor-id="método-embedded-3"><span class="header-section-number">8.4.3</span> Método embedded</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false" href="">K</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false" href="">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>El KNN ha sido hasta el momento el modelo que mejor AUC medio ha dado, estando el más alto en 0.945, presentando además robustez en la medida. Además es un modelo sencillo, que solo consta de un hiperparámetro y se encuentra en torno a 29 su mejor valor. Las variables que más veces han salido teniendo en cuenta los tres métodos son: <code>F.DIAG</code>, <code>ESTADIO</code>, <code>HER2</code>, <code>CIRUGIA</code>, <code>MENOP</code>, <code>GANGLIOS</code> y <code>FENOTIPO</code>.</p>
<p>En general ha sido un modelo con muy buenos resultados, que junto a su simpleza, hace que sea un modelo potencialmente favorito como modelo final.</p>
</section>
</section>
<section id="naive-bayes" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="naive-bayes"><span class="header-section-number">8.5</span> Naive Bayes</h2>
<p>Naive Bayes es un clasificador probabilístico basado en el teorema de Bayes. Calcula la probabilidad a priori de cada clase en el conjunto de datos y y evalúa la verosimilitud de que cada variable aparezca en una clase determinada. Por último calcula la probabilidad a posteriori. Este modelo no tiene hiperparámetros, así que lo único que se evaluará es el AUC y las variables. El paquete usado es <code>e1071</code>.</p>
<section id="método-de-filtrado-4" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="método-de-filtrado-4"><span class="header-section-number">8.5.1</span> Método de filtrado</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true" href="">AUC</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="método-wrapper-4" class="level3" data-number="8.5.2">
<h3 data-number="8.5.2" class="anchored" data-anchor-id="método-wrapper-4"><span class="header-section-number">8.5.2</span> Método wrapper</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false" href="">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="método-embedded-4" class="level3" data-number="8.5.3">
<h3 data-number="8.5.3" class="anchored" data-anchor-id="método-embedded-4"><span class="header-section-number">8.5.3</span> Método embedded</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false" href="">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Sorprendentemente, este modelo a pesar del gran desbalanceo de datos en la variable de estudio, ha logrado unos AUC similares a otros modelos, siendo la media más alta 0.869. Naive Bayes suele ser un modelo que predice la clase mayoritaria en caso de haber clases desbalanceadas, por lo que teóricamente no es el más indicado. No obstante, las variables también mantienen una robustez y se encuentran entre las mayoritarias las más comunes: <code>F.DIAG</code>, <code>ESTADIO</code>,<code>CIRUGIA</code>, <code>TAM</code>, <code>EDAD_DCO</code> y <code>RE</code>.</p>
</section>
</section>
<section id="random-forest" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="random-forest"><span class="header-section-number">8.6</span> Random forest</h2>
<p>Random forest construye múltiples árboles de decisión durante el entrenamiento. La predicción final se determina mediante un voto mayoritario entre todas las predicciones de los árboles individuales. En otras palabras, se combinan distintos modelos débiles en uno fuerte, reduciendo así el riesgo de sobreajuste. El paquete usado es <code>randomForest</code> y los parámetros a ajustar son:</p>
<ul>
<li><strong>Ntree</strong>: indica el número de árboles que se construirán en el modelo.</li>
<li><strong>Maxnodes</strong>: establece el número máximo de hojas permitidos en cada uno de los árboles.</li>
</ul>
<p>Tras la exploración inicial, es espacio de búsqueda es el siguiente:</p>
<ul>
<li><strong>Ntree</strong>: 55, 65</li>
<li><strong>Maxnodes</strong>: 55, 65</li>
</ul>
<section id="método-de-filtrado-5" class="level3" data-number="8.6.1">
<h3 data-number="8.6.1" class="anchored" data-anchor-id="método-de-filtrado-5"><span class="header-section-number">8.6.1</span> Método de filtrado</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false" href="">Ntree</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false" href="">Maxnodes</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="método-wrapper-5" class="level3" data-number="8.6.2">
<h3 data-number="8.6.2" class="anchored" data-anchor-id="método-wrapper-5"><span class="header-section-number">8.6.2</span> Método wrapper</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false" href="">Ntree</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false" href="">Maxnodes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-4" role="tab" aria-controls="tabset-19-4" aria-selected="false" href="">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-19-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-4-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="método-embedded-5" class="level3" data-number="8.6.3">
<h3 data-number="8.6.3" class="anchored" data-anchor-id="método-embedded-5"><span class="header-section-number">8.6.3</span> Método embedded</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false" href="">Ntree</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false" href="">Maxnodes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-4" role="tab" aria-controls="tabset-20-4" aria-selected="false" href="">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-20-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-4-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>El AUC parece no ser tan robusto como en otros modelos, además de tener un valor más bajo, siendo la media más alta de 0.812 y dando el método embedded valores incluso por debajo de 0.5. Para el hiperparámetro Ntree, parece no haber tampoco un consenso, aunque la moda es 55 en los tres métodos. Tampoco parece haberlo para Maxnodes, aunque esta vez la moda difiere entre los métodos.</p>
<p>De acuerdo con las variables, parece ser menos clara la decisión respecto a otros modelos. Las más frecuentes en el método embedded son <code>F.DIAG</code>, <code>ESTADIO</code>,<code>CIRUGIA</code>, mientras que según el método wrapper, prácticamente o todas las variables son relevantes para el modelo.</p>
<p>Resumiendo, no es el modelo más robusto, ni en métricas ni en variables, a parte de no encontrarse entre los de mejor rendimiento, por lo que probablemente no sea la mejor opción.</p>
</section>
</section>
<section id="adaboost" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="adaboost"><span class="header-section-number">8.7</span> Adaboost</h2>
<p>El algoritmo AdaBoost funciona entrenando secuencialmente una serie de modelos débiles, donde cada uno se enfoca más en los casos que fueron mal clasificados por los modelos anteriores. Finalmente, se combinan los modelos en un modelo fuerte mediante un voto ponderado. El paquete usado es <code>adabag</code>, y el parámetro ajustado es <strong>Mfinal</strong>, que indica el número de iteraciones para el proceso de boosting.</p>
<section id="filtrado" class="level3" data-number="8.7.1">
<h3 data-number="8.7.1" class="anchored" data-anchor-id="filtrado"><span class="header-section-number">8.7.1</span> Filtrado</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true" href="">AUC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false" href="">Mfinal</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega_Final_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>El <strong>AUC</strong> parece ser robusto y muestra un valor decente de 0.888. Sin embargo, en el hiperparámetro <code>MFinal</code> parece no haber un consenso, por lo que se cogería 80 como valor en un modelo final.</p>
<p>Los otros dos métodos no se muestran por un problema en la ejecución. Estos se ejecutaban infinitamente y no acababan a pesar de ser pacientes a la espera de resultados.</p>
</section>
</section>
</section>
<section id="comparación-de-los-métodos-de-selección-de-variables" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Comparación de los métodos de selección de variables</h1>
<p>Los distintos algoritmos de selección de variables que se han usado en este informe, presentan diferencias a tener en cuenta. Sin embargo, estos pueden complementarse, siendo la mejor opción siempre que se tengan los recursos suficientes, usar los tres métodos para ver la robustez del modelo.</p>
<p>El flujo seguido en la realización de este proyecto, ha sido el del ajuste inicial de parámetros usando el método de filtrado, ya que es muy rápido en ejecutarse. Además se ha podido observar que las variables elegidas según este criterio se corresponden en gran medida con las de los otros dos métodos de selección, que en teoría son “más precisos”.</p>
<p>El método wrapper da buenos resultados, pero el tiempo de cómputo se dispara. En cuanto al método embedded, también ha dado buenos resultados en regla general y es considerablemente más rápido que el wrapper. Sin embargo, en su ejecución se lanzaba un aviso, advirtiendo del bajo número de datos para algunas clases debido al desbalanceo del conjunto de datos. Esto ha producido en algunos modelos un rendimiento mucho peor en este método, debido a problemas de generalización e inestabilidad.</p>
</section>
<section id="modelo-final" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Modelo final</h1>
<p>El mejor modelo según el parámetro <strong>AUC</strong> es el KNN, con un mejor AUC medio de 0.945. Sin embargo, ANN tiene un mejor AUC de 0.911, pero su media de todos los métodos de filtrado de variables es mayor, por lo que se elegirá ANN como modelo final por su excelente rendimiento y robustez.</p>
<p>Se han vuelto a sacar las métricas usando el double cross validation, pero esta vez con los hiperparámetros y variables finales. De esta manera se obtienen unas métricas finales lo más robustas y fiables posibles. Los parámetros finales son:</p>
<ul>
<li><strong>Size</strong>: 16</li>
<li><strong>Decay</strong>: 0.2</li>
<li><strong>Variables</strong>: ESTADIO, F.DIAG, RE y TAM</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">AUC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Precisión</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Recall</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F1-Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right; font-weight: bold;">0.912078</td>
<td style="text-align: right;">0.0466033</td>
<td style="text-align: right;">0.968</td>
<td style="text-align: right;">0.0888989</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Como se puede observar, el AUC y el Recall son excelentes, pero no la precisión y el F1-score (fruto de la precisión). Esto se debe al gran desbalanceo de datos, que se acentúa más incluso al hacer las divisiones del cross validation, por lo que no debería ser alarmante teniendo el cuenta las condiciones.</p>
<p>Por tanto, para la aplicación shiny se usará este modelo con las variables especificadas anteriormente, entrenado con todo el conjunto de datos.</p>
</section>
<section id="shiny-app" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Shiny APP</h1>
<iframe src="https://pbbldd-gonzalo-mesas0aranda.shinyapps.io/modeloFinal/" width="100%" height="500px"></iframe>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Ejecutar el código</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Aprendizaje Computacional"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Gonzalo Mesas Aranda"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">    theme:</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">      light: flatly</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">      dark: darkly</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: monokai</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "Contenidos"</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-float:</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">      collapsed: false</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">      smooth-scroll: true</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">    toc_scroll: true</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: </span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">      source: true</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">      toggle: true</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">      caption: "Expand Code"</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">    html-math-method: katex</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">    lang: es</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">    navbar:</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">      right:</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">        - icon: github</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">          href: "https://github.com/GonzaloM786"</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">          text: "Perfil de Github"</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">#knitr::opts_chunk$set(echo = TRUE)</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"C:/Users/Gonzalo_MA/Desktop/Universidad/Tercero/Mineria de datos/funcion-preprocesado.R"</span>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>calcular.moda <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  ux <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  ux[<span class="fu">which.max</span>(<span class="fu">tabulate</span>(<span class="fu">match</span>(x, ux)))]</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>imputar.con.moda <span class="ot">&lt;-</span> <span class="cf">function</span>(df, column) {</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  mode_val <span class="ot">&lt;-</span> <span class="fu">calcular.moda</span>(df[[column]])</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  df[[column]][df[[column]] <span class="sc">==</span> <span class="st">""</span>] <span class="ot">&lt;-</span> mode_val</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>imputar_con_moda <span class="ot">&lt;-</span> <span class="cf">function</span>(df, column) {</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  mode_val <span class="ot">&lt;-</span> <span class="fu">calcular.moda</span>(df[[column]])</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  df[[column]][<span class="fu">is.na</span>(df[[column]])] <span class="ot">&lt;-</span> mode_val</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>imputar_por_media <span class="ot">&lt;-</span> <span class="cf">function</span>(df, columna) {</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  media_columna <span class="ot">&lt;-</span> <span class="fu">mean</span>(df[[columna]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  df[[columna]][<span class="fu">is.na</span>(df[[columna]])] <span class="ot">&lt;-</span> media_columna</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>visualizar.barras <span class="ot">&lt;-</span> <span class="cf">function</span>(df, variable, <span class="at">vertical_labels =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Crear tabla de frecuencias</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  freq_table <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by_at</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Frecuencia =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Crear gráfico de barras con etiquetas de frecuencia</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(variable), <span class="at">fill =</span> <span class="sc">!!</span><span class="fu">sym</span>(variable))) <span class="sc">+</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> freq_table, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(variable), <span class="at">y =</span> Frecuencia, <span class="at">label =</span> Frecuencia), </span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Gráfico de barras de la variable categorica"</span>, variable),</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Categoría"</span>,</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Categoría"</span>) <span class="sc">+</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (vertical_labels) {</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>visualizar.distribucion <span class="ot">&lt;-</span> <span class="cf">function</span>(df, variable) {</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcular estadísticas</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  media <span class="ot">&lt;-</span> <span class="fu">mean</span>(df[[variable]])</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  varianza <span class="ot">&lt;-</span> <span class="fu">var</span>(df[[variable]])</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  minimo <span class="ot">&lt;-</span> <span class="fu">min</span>(df[[variable]])</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>  maximo <span class="ot">&lt;-</span> <span class="fu">max</span>(df[[variable]])</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> .data[[variable]])) <span class="sc">+</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> media), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> media, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">"Media"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">angle =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Distribución de"</span>, variable),</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Media:"</span>, <span class="fu">round</span>(media, <span class="dv">3</span>), <span class="st">"Varianza:"</span>, <span class="fu">round</span>(varianza, <span class="dv">3</span>), </span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Min:"</span>, <span class="fu">round</span>(minimo, <span class="dv">3</span>), <span class="st">"Max:"</span>, <span class="fu">round</span>(maximo, <span class="dv">3</span>)),</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> variable,</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Densidad"</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>obtener_df <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">escalado=</span><span class="cn">TRUE</span>){</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Importacion</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">"C:/Users/Gonzalo_MA/Desktop/Universidad/Tercero/Mineria de datos/Entrega_Final/exam_dataset_10.csv"</span>,</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header=</span> T, <span class="at">dec=</span><span class="st">","</span>)</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">imputar_por_media</span>(df, <span class="st">"EDAD_DCO"</span>)</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">imputar_por_media</span>(df, <span class="st">"TAM"</span>)</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">imputar_por_media</span>(df, <span class="st">"RE"</span>)</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">imputar_por_media</span>(df, <span class="st">"RP"</span>)</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">imputar_por_media</span>(df, <span class="st">"KI67"</span>)</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(escalado){</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>EDAD_DCO <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>EDAD_DCO)[,<span class="dv">1</span>]</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>TAM <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>TAM)[,<span class="dv">1</span>]</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>RE <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>RE)[,<span class="dv">1</span>]</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>RP <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>RP)[,<span class="dv">1</span>]</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>KI67 <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>KI67)[,<span class="dv">1</span>]</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>F.DIAG <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(df<span class="sc">$</span>F.DIAG, <span class="at">format=</span><span class="st">"%Y-%m-%d %H:%M:%S"</span>)</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>F.DIAG <span class="ot">&lt;-</span> <span class="fu">format</span>(df<span class="sc">$</span>F.DIAG, <span class="st">"%Y"</span>)</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>F.DIAG <span class="ot">&lt;-</span> (<span class="fu">as.integer</span>(df<span class="sc">$</span>F.DIAG) <span class="sc">%/%</span> <span class="dv">10</span>)</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>HISTOLOGIA[df<span class="sc">$</span>HISTOLOGIA <span class="sc">==</span> <span class="st">""</span>] <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Conversión a tipo factor</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>  variables_a_cambiar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"F.DIAG"</span>, <span class="st">"MENOP"</span>, <span class="st">"CIRUGIA"</span>, <span class="st">"HISTOLOGIA"</span>, <span class="st">"GRADO"</span>, <span class="st">"HER2"</span>, <span class="st">"FENOTIPO"</span>, <span class="st">"GANGLIOS"</span>, <span class="st">"ESTADIO"</span>, <span class="st">"ESTADO_ACTUAL"</span>)</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  df[variables_a_cambiar] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df[variables_a_cambiar], factor)</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>ESTADIO <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(df<span class="sc">$</span>ESTADIO, <span class="st">'IA'</span> <span class="ot">=</span> <span class="st">"I"</span>, <span class="st">'IB'</span> <span class="ot">=</span> <span class="st">"I"</span>, <span class="st">'IC'</span> <span class="ot">=</span> <span class="st">"I"</span>,</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'IIA'</span> <span class="ot">=</span> <span class="st">"II"</span>, <span class="st">'IIB'</span> <span class="ot">=</span> <span class="st">"II"</span>,</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'IIIA'</span> <span class="ot">=</span> <span class="st">'III'</span>, <span class="st">'IIIB'</span> <span class="ot">=</span> <span class="st">'III'</span>, <span class="st">'IIIC'</span> <span class="ot">=</span> <span class="st">'III'</span>, <span class="st">'0is'</span> <span class="ot">=</span> <span class="st">""</span>)</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Muerto: 1</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Vivo: 0</span></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>ESTADO_ACTUAL <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(df<span class="sc">$</span>ESTADO_ACTUAL, <span class="st">"MCE"</span> <span class="ot">=</span> <span class="st">"1"</span>, <span class="st">"MSE"</span> <span class="ot">=</span> <span class="st">"1"</span>, <span class="st">"MXE"</span> <span class="ot">=</span> <span class="st">"1"</span>, <span class="st">"VCE"</span> <span class="ot">=</span> <span class="st">"0"</span>, <span class="st">"VSE"</span> <span class="ot">=</span> <span class="st">"0"</span>)</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>GRADO <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(df<span class="sc">$</span>GRADO, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"I"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"II"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"III"</span>)</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">imputar.con.moda</span>(df, <span class="st">"MENOP"</span>)</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">imputar.con.moda</span>(df, <span class="st">"CIRUGIA"</span>)</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">imputar.con.moda</span>(df, <span class="st">"HER2"</span>)</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">imputar.con.moda</span>(df, <span class="st">"FENOTIPO"</span>)</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">imputar.con.moda</span>(df, <span class="st">"ESTADIO"</span>)</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">imputar_con_moda</span>(df, <span class="st">"GRADO"</span>)</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">imputar_con_moda</span>(df, <span class="st">"GANGLIOS"</span>)</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>GANGLIOS <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df<span class="sc">$</span>GANGLIOS)</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>GANGLIOS <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span>GANGLIOS)</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">GANGLIOS =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>      GANGLIOS <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"NINGUNO"</span>,</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>      GANGLIOS <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> GANGLIOS <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"LEVE"</span>,</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>      GANGLIOS <span class="sc">&gt;=</span> <span class="dv">4</span> <span class="sc">&amp;</span> GANGLIOS <span class="sc">&lt;=</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">"MODERADO"</span>,</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>      GANGLIOS <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"SEVERO"</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>  df[variables_a_cambiar] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df[variables_a_cambiar], factor)</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">obtener_df</span>()</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>df_sin_escalar <span class="ot">&lt;-</span> <span class="fu">obtener_df</span>(<span class="at">escalado =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a><span class="fu"># Abstact</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>En este proyecto se ha estudiado un conjunto de datos de pacientes con cáncer de mama desde diferentes acercamientos. Primero se ha realizado un análisis estadístico de los datos, imprescindible en este tipo de estudios, donde se ha obtenido información valiosa y explicativa de la variable de estudio. Posteriormente se han analizado diferentes modelos predictivos usando una estimación robusta de los parámetros y métricas, de donde se ha podido concluir el ANN como mejor modelo por su robustez y excelente rendimiento. Por último se ha lanzado el modelo final en una aplicación Shiny para su uso en un entorno real.</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>Para más información sobre el código, visitar mi repositorio de <span class="co">[</span><span class="ot">GitHub</span><span class="co">](https://github.com/GonzaloM786/Funciones-para-analisis-estadisticos-en-R)</span>.</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a><span class="fu"># Flujo de trabajo</span></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span><span class="ot">=</span><span class="st">"flujo.png"</span> <span class="er">alt</span><span class="ot">=</span><span class="st">"Flujo de trabajo"</span> <span class="er">style</span><span class="ot">=</span><span class="st">"width: 95%; height: auto;"</span><span class="kw">/&gt;</span></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a><span class="fu"># Preprocesamiento</span></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>El preprocesamiento es un paso esencial en el análisis de datos. No simplemente se normalizan y limpian los datos sino que también se llevan a cabo transformaciones que incluso afecta al rendimiento final de los modelos predictivos. A continuación se describirán las diferentes variables del conjunto de datos y se detallarán los cambios a los que han sido sometidas, si los hay.</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Edad al diagnóstico**: edad del paciente en el momento en que se le diagnosticó cáncer de mama.</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Fecha al diagnóstico**: fecha en que se diagnosticó cáncer de mama. Se ha estratificado por décadas.</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Estado menopáusico**: indica si la paciente es premenopáusica o postmenopáusica.</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Tipo de cirugía**: tipo de intervención quirúrgica realizada.</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Histología**: tipo de tejido del tumor y su apariencia microscópica. Más adelante se comentará la decisión final sobre esta variable.</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Tamaño**: tamaño del tumor.</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Grado**: comparación de las células tumorales bajo el microscopio en comparación con las células normales.</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**RE**: receptores de estrógeno en las células tumorales.</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**RP**: receptores de progesterona en las células tumorales.</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Her2**: sobreexpresión del gen HER2.</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**ki67**: marcador de proliferación celular que indica la rapidez con la que crecen las células cancerosas.</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Fenotipo_IHQ**: clasificación del tumor basada en la expresión de ciertos marcadores inmunohistoquímicos.</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Ganglios**: número de ganglios linfáticos afectados por el cáncer. En función del número se han agrupado en cuatro categorías según la gravedad.</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Estadio**: clasificación del cáncer en etapas, según el tamaño del tumor, afectación de ganglios y presencia de metástasis. Se han agrupado las distintas categorías en valores entre I y IV.</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Estado actual**: estado vital actual del paciente, puede ser fallecido o vivo. Se ha simplificado a variable binaria, agrupando los distintos tipos de fallecimiento y pacientes vivos.</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>Para todas las variables, los datos faltantes han sido imputados con la **media** y la **moda** para las variables numéricas y categóricas respectivamente. Además, todas las variables numéricas han sido estandarizadas, es decir que sus medias son cero y desviaciones estándar uno. </span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a><span class="fu"># Estadística descriptiva</span></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>La estadística descriptiva proporciona una visión general de la distribución y comportamiento de los datos. Es importante en este contexto, ya que ayuda a identificar valores atípicos o clases desbalanceadas. Aquí las distribuciones de las variables del modelo.</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variables categóricas</span></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a><span class="fu">### F.DIAG</span></span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.barras</span>(df, <span class="st">"F.DIAG"</span>)</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a><span class="fu">### MENOP</span></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.barras</span>(df, <span class="st">"MENOP"</span>)</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a><span class="fu">### CIRUGIA</span></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.barras</span>(df, <span class="st">"CIRUGIA"</span>)</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a><span class="fu">### HISTOLOGIA</span></span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.barras</span>(df, <span class="st">"HISTOLOGIA"</span>, <span class="at">vertical_labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a><span class="fu">### GRADO</span></span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.barras</span>(df, <span class="st">"GRADO"</span>)</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a><span class="fu">### HER2</span></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.barras</span>(df, <span class="st">"HER2"</span>)</span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a><span class="fu">### FENOTIPO</span></span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.barras</span>(df, <span class="st">"FENOTIPO"</span>, <span class="at">vertical_labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a><span class="fu">### GANGLIOS</span></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.barras</span>(df, <span class="st">"GANGLIOS"</span>)</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a><span class="fu">### ESTADIO</span></span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.barras</span>(df, <span class="st">"ESTADIO"</span>)</span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a><span class="fu">### ESTADO_ACTUAL</span></span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.barras</span>(df, <span class="st">"ESTADO_ACTUAL"</span>)</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>Se pueden observar las frecuencias absolutas de las distintas variables, de las cuales hay algunas que están relativamente **desbalanceadas**. Cabe destacar la variable de estudio `ESTADO_ACTUAL`, donde el 95.2% de los datos pertenecen a la clase "viva", lo cual va suponer una dificultad en el entrenamiento de algunos modelos predictivos, ya que puede ocurrir que estos se decanten por la clasificación mayoritaria simplemente por el hecho de serlo. Además, en la variable `HISTOLOGIA` existen 324 valores faltantes, además de que el resto de las clases tienen una frecuencia muy reducida salvo DUCTAL. Por esta razón, a pesar de ser una variable potencialmente importante y significativa, las condiciones van a producir problemas como la introducción de ruido, complejidad y errores en los distintos algoritmos de ajuste de los modelos, por lo que **se eliminará** del estudio.</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>HISTOLOGIA <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variables numéricas</span></span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a><span class="fu">### EDAD_DCO</span></span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(df_sin_escalar, <span class="st">"EDAD_DCO"</span>)</span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a><span class="fu">### TAM</span></span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(df_sin_escalar, <span class="st">"TAM"</span>)</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a><span class="fu">### RE</span></span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(df_sin_escalar, <span class="st">"RE"</span>)</span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a><span class="fu">### RP</span></span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(df_sin_escalar, <span class="st">"RP"</span>)</span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a><span class="fu">### KI67</span></span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(df_sin_escalar, <span class="st">"KI67"</span>)</span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>Estas distribuciones se han obtenido sobre el conjunto de datos sin estandarizar para mayor interpretabilidad, aunque se usará el su versión estandarizada para el resto del estudio y todos los cálculos.</span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a>Los pacientes tienen una media de edad de 57 años y las distribuciones suelen estar concentradas cerca de la media, salvo en <span class="in">`RE`</span> y <span class="in">`RP`</span>, donde sobre todo en <span class="in">`RP`</span> se distinguen dos claros grupos.</span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a><span class="fu"># Análisis de asociación</span></span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a>La siguiente figura muestra los resultados de la estadística bivariable, es decir el **p-valor** resultante del test correspondiente a cada par de variables. En verde se muestran aquellas con un p-valor por debajo de 0.05, es decir, las diferencias en sus distribuciones muy probablemente no sean fruto del azar.</span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.estadistica</span>(df)</span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>La información más destacable son las variables relacionadas con la variable de estudio, las cuales son: **ESTADIO, F.DIAG, RE y TAM**. Aunque no haya relación directa con el grado de explicabilidad de las mismas respecto a la variable de estudio o su eficacia en modelos predictivos, estas variables son potencialmente importantes en este estudio, por lo que se tendrán en cuenta para el modelo explicativo y se usarán en los métodos de filtrado.</span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a><span class="fu"># Análisis multivariante</span></span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a>El objetivo del análisis multivariante es estudiar si hay alguna combinación de variables donde haya alguna variable/s que expliquen con una buena confianza la variable de estudio. Para ello se probará la regresión logística con tres conjuntos de variables distintas. Al final se proporciona una tabla resumen con los resultados.</span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelo con todas las variables</span></span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a>Se comprobará el comportamiento del modelo explicativo con todas las variables.</span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a>Solo cuatro variables de todo el modelo tienen un p-valor menor a 0.05, las cuales son en las que se puede confiar para explicar la variable de estudio. Esta afirmación esta basada en que el p-valor representa la probabilidad de observar un z-value (estimate entre error estándar) tan extremo como el observado.</span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a>Se puede deducir en función del estimate de las variables que cumplen esta condición, si influyen positivamente o negativamente al evento de estudio mirando el signo de este. Por ejemplo, **a más edad, estadio** y si la paciente es **premenopáusica**, hay **más probabilidades** de que el evento sea "fallecido"; mientras que si el diagnóstico se produjo en la década de los 2010s, hay menos probabilidades, lo cual parece ser coherente.</span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE, results='asis'}</span></span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">glm</span>(ESTADO_ACTUAL<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> ., <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">"logit"</span>))</span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a>resumen_modelo <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">summary</span>(modelo))</span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'&lt;details&gt;&lt;summary&gt;Mostrar/Ocultar Resumen del Modelo&lt;/summary&gt;&lt;pre&gt;'</span>,</span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(resumen_modelo, <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>),</span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;/pre&gt;&lt;/details&gt;'</span>)</span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelo con las variables filtradas</span></span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a>Para este modelo se usarán las variables que obtuvieron un p-valor menor a 0.05 en el análisis bivariable respecto a la variable de estudio: **ESTADIO, F.DIAG, RE y TAM**. Se puede observar el mismo patrón que antes para las variables <span class="in">`ESTADIO`</span> y <span class="in">`F.DIAG`</span>.</span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE, results='asis'}</span></span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">glm</span>(ESTADO_ACTUAL<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> ESTADIO <span class="sc">+</span> F.DIAG <span class="sc">+</span> RE <span class="sc">+</span> TAM, <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">"logit"</span>))</span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a>resumen_modelo <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">summary</span>(modelo))</span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'&lt;details&gt;&lt;summary&gt;Mostrar/Ocultar Resumen del Modelo&lt;/summary&gt;&lt;pre&gt;'</span>,</span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(resumen_modelo, <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>),</span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;/pre&gt;&lt;/details&gt;'</span>)</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelo usando stepAIC</span></span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a>En este último modelo, se comenzará con todas las variables y se eliminarán de acuerdo con el método de selección de variables "stepAIC backward". Las variables seleccionadas son todas significativas y se corresponden con las que tuvieron un p-valor menor a 0.05 en el modelo con todas las variables. Se pueden observar los mismos patrones de influencia en la variable de estudio.</span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE, results='asis'}</span></span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">glm</span>(ESTADO_ACTUAL<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> ., <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">"logit"</span>))</span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">capture.output</span>(modelo <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(modelo, <span class="at">direction =</span> <span class="st">"backward"</span>)))</span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a>resumen_modelo <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">summary</span>(modelo))</span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'&lt;details&gt;&lt;summary&gt;Mostrar/Ocultar Resumen del Modelo&lt;/summary&gt;&lt;pre&gt;'</span>,</span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(resumen_modelo, <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>),</span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a>    <span class="st">'&lt;/pre&gt;&lt;/details&gt;'</span>)</span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tabla resumen</span></span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>  <span class="at">Campo =</span> <span class="fu">c</span>(<span class="st">"Variables significativas"</span>, <span class="st">"Null deviance"</span>, <span class="st">"Residual deviance"</span>, <span class="st">"AIC"</span>),</span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a>  <span class="at">Todas =</span> <span class="fu">c</span>(<span class="st">"EDAD_DCO ** </span><span class="sc">\n</span><span class="st">F.DIAG201 *** </span><span class="sc">\n</span><span class="st">MENOPPREMENOPAUSICA * </span><span class="sc">\n</span><span class="st">ESTADIOIII * </span><span class="sc">\n</span><span class="st">ESTADIOIV ***"</span>,</span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a>            <span class="st">"192.58"</span>, <span class="st">"101.5"</span>, <span class="st">"145.5"</span>),</span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a>  <span class="at">Filtradas =</span> <span class="fu">c</span>(<span class="st">"ESTADIOIII * ESTADIOIV *** F.DIAG201 ***"</span>, <span class="st">"192.58"</span>, <span class="st">"120.84"</span>, <span class="st">"134.84"</span>),</span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a>  <span class="at">Step =</span> <span class="fu">c</span>(<span class="st">"EDAD_DCO *** F.DIAG201 *** MENOPPREMENOPAUSICA * ESTADIOII * ESTADIOIII ** ESTADIOIV ***"</span>,</span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a>           <span class="st">"192.58"</span>, <span class="st">"109.29"</span>, <span class="st">"123.29"</span>)</span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear la tabla visual usando kableExtra</span></span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(datos, <span class="st">"html"</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Campo"</span>, <span class="st">"Todas las variables"</span>, <span class="st">"Variables filtradas"</span>, <span class="st">"StepAIC"</span>), <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>),</span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> F, </span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="st">"center"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"20em"</span>)</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a>Las conclusiones que se pueden sacar del modelo explicativo son que la edad y estadío aumentan el riesgo de muerte, mientras que una fecha de diagnóstico más tardía lo reduce, lo cual es trivial. Además, lo más interesante puede ser que la condición premenopáusica aumenta el riesgo de muerte. Esto no implica que haya causalidad entre ambas variables, pero sí una correlación, por lo que no por ser premenopáusica (más jóven en general) se tiene mayor riesgo, sino que este conjunto de pacientes tienen unas condiciones más agresivas en general (estadío más avanzado, más ganlios afectados, etc.). Este dato es objeto de un estudio más profundo y debe ser interpretado por un porfesional de la salud.</span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a><span class="fu"># Modelos predictivos</span></span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a>En este apartado se analizarán los resultados de diferentes modelos predictivos usando una evaluación honesta con el **5x2 Double Cross Validation**. Se usarán para cada modelo, tres métodos de selección de variables: filtrado (p-vlor menor a 0.05 en el análisis bivariable), wrapper (stepAUC backward) y embedded (modelo lasso). Se usará el AUC como métrica para elegir el mejor modelo.</span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>Todas las funciones creadas que implementan la doble validación cruzada, toman una lista con los rangos de los hiperparámetros que se van a probar. Para ello, primeramente se debe hacer un análisis exploratorio, donde se prueba el modelo midiendo las métricas aparentes, en este caso el **AUC** ya que es una métrica independiente al umbral y engloba otras. Además, en un entorno clínico como este, es común usar esta métrica por su familiaridad por parte del personal sanitario.</span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a>En el análisis exploratorio, se acotan entonces los rangos de búsqueda de hiperparámetros. Después se puede proceder con la doble validación cruzada, de donde se obtendrán métricas robustas y honestas. Además se repite esta para cinco valores distintos de semillas, con el objetivo de no depender tanto de la misma.</span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a><span class="fu">## Marco teórico</span></span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a><span class="fu">### Doble validación cruzada</span></span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a>La doble validación cruzada es una técnica de validación interna que tiene como objetivo proporcionar una evaluación robusta del rendimiento del modelo. Además es comúnmente usada para el ajuste de hiperparámetros. Concretamente, en este informe se usará una disposición 5x2, lo cual se refiere al número de folds externos e internos respectivamente. A continuación se muestra un esquema representativo:</span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span><span class="ot">=</span><span class="st">"crossValidation.png"</span> <span class="er">alt</span><span class="ot">=</span><span class="st">"Esquema del Double Cross Validation"</span> <span class="er">style</span><span class="ot">=</span><span class="st">"width: 95%; height: auto;"</span><span class="kw">/&gt;</span></span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a>La idea principal es que los cinco folds de test, se reservan para calcular las métricas honestas del modelo, sin que estos datos hayan servido para entrenar o validar el mismo. El resto de los datos que no son de test, se dividen en dos y se usan para entrenamiento y validación, donde se realizará la búsqueda de los mejores parámetros.</span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a><span class="fu">## Métodos de filtrado</span></span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a>Estos métodos de selección de variables se basan en estadísticas de los datos, sin tener en cuenta ninguna métrica o modelo de Machine Learning. Primeramente se seleccionan las variables, que en este caso se han elegido las que mantienen un p-valor menor a 0.05 en el resultado del test estadístico respecto a la variable de estudio. Después se procede con el método de validación interna, manteniendo estas variables fijas. Las variables seleccionadas por este criterio son: **ESTADIO, F.DIAG, RE y TAM**, las cuales son las que se usarán siempre que se use este método.</span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a><span class="fu">## Métodos wrapper</span></span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a>A diferencia de los de filtrado, estos sí que se basan en el rendimiento del modelo. Se basan en la elección de variables que optimicen una métrica concreta. Hay de distintos tipos, pero aquí se usa el **Backward Elimination**, el cual parte de todas las variables y va eliminando aquellas que aumenten más la métrica usada, hasta que no haya variable que la mejora al quitarla.</span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a><span class="fu">## Métodos embedded</span></span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a>Los métodos embedded usan modelos que penalizan la importancia de las variables menos relevantes. Estos métodos seleccionan variables al mismo tiempo que ajustan los parámetros. Concretamente, se usará el **modelo lasso**, que penaliza la suma de los valores absolutos de los coeficientes, eliminando algunos completamente. Se usará el paquete <span class="in">`glmnet`</span>, el cual para el modelo lasso necesita que las variables categóricas estén codificadas en formato one-hot-encoding.</span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generación de métricas</span></span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a>Para cada uno de los modelos usados, se han obtenido métricas usando doble validación cruzada para los tres métodos de selección de variables (filtrado, wrapper y embedded). Por tanto, para cada modelo existen tres tablas de información, las cuales se discutirán más adelante.</span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a>Debido a la gran cantidad de tiempo de computo necesaria para la generación de todos estos datos, se han computado y guardado en ficheros RData, los cuales se usarán en este informe para su interpretación.</span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a>frecuencia_variables <span class="ot">&lt;-</span> <span class="cf">function</span>(metricas){</span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a>  variables_separadas <span class="ot">&lt;-</span> metricas <span class="sc">%&gt;%</span></span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Variables =</span> <span class="fu">strsplit</span>(Variables, <span class="st">", "</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(Variables)</span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a>  conteo_variables <span class="ot">&lt;-</span> variables_separadas <span class="sc">%&gt;%</span></span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Variables) <span class="sc">%&gt;%</span></span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Frecuencia =</span> <span class="fu">n</span>())</span>
<span id="cb1-458"><a href="#cb1-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-459"><a href="#cb1-459" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Crear el gráfico de barras</span></span>
<span id="cb1-460"><a href="#cb1-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(conteo_variables, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Variables, Frecuencia), <span class="at">y =</span> Frecuencia)) <span class="sc">+</span></span>
<span id="cb1-461"><a href="#cb1-461" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb1-462"><a href="#cb1-462" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frecuencia de Variables Seleccionadas"</span>,</span>
<span id="cb1-463"><a href="#cb1-463" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Variables"</span>,</span>
<span id="cb1-464"><a href="#cb1-464" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Frecuencia"</span>) <span class="sc">+</span></span>
<span id="cb1-465"><a href="#cb1-465" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-466"><a href="#cb1-466" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()  <span class="co"># Para que las etiquetas se vean mejor</span></span>
<span id="cb1-467"><a href="#cb1-467" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-468"><a href="#cb1-468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-469"><a href="#cb1-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-470"><a href="#cb1-470" aria-hidden="true" tabindex="-1"></a><span class="fu">## Redes Neuronales</span></span>
<span id="cb1-471"><a href="#cb1-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-472"><a href="#cb1-472" aria-hidden="true" tabindex="-1"></a>Se utilizará el paquete <span class="in">`nnet`</span> para estimar el modelo. Los parámetros que se ajustarán son los siguientes:</span>
<span id="cb1-473"><a href="#cb1-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-474"><a href="#cb1-474" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Size**: indica el número de neuronas en la capa oculta.</span>
<span id="cb1-475"><a href="#cb1-475" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Decay**: controla la tasa de regularización aplicada a los pesos. Se usa para prevenir el sobreajuste, de manera que cuanto mayor sea este parámetro, mayor es la penalización, lo que da lugar a modelos más generalizables.</span>
<span id="cb1-476"><a href="#cb1-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-477"><a href="#cb1-477" aria-hidden="true" tabindex="-1"></a>Con la exploración inicial de los parámetros del modelo, junto al uso de la doble validación cruzada con método de filtrado, debido a su bajo tiempo de ejecución, los parámetros han sido acotados en este rango:</span>
<span id="cb1-478"><a href="#cb1-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-479"><a href="#cb1-479" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Size**: 15, 17, 20, 23</span>
<span id="cb1-480"><a href="#cb1-480" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Decay**: 0.1, 0.3</span>
<span id="cb1-481"><a href="#cb1-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-482"><a href="#cb1-482" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método de filtrado</span></span>
<span id="cb1-483"><a href="#cb1-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-484"><a href="#cb1-484" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-485"><a href="#cb1-485" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-486"><a href="#cb1-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-487"><a href="#cb1-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-488"><a href="#cb1-488" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/ann_filtered.RData"</span>)</span>
<span id="cb1-489"><a href="#cb1-489" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_ann_filtered</span></span>
<span id="cb1-490"><a href="#cb1-490" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_ann_filtered, <span class="st">"Auc"</span>)</span>
<span id="cb1-491"><a href="#cb1-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-492"><a href="#cb1-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-493"><a href="#cb1-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-494"><a href="#cb1-494" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Size</span></span>
<span id="cb1-495"><a href="#cb1-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-496"><a href="#cb1-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-497"><a href="#cb1-497" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_ann_filtered, <span class="st">"Size"</span>)</span>
<span id="cb1-498"><a href="#cb1-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-499"><a href="#cb1-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-500"><a href="#cb1-500" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Decay</span></span>
<span id="cb1-501"><a href="#cb1-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-502"><a href="#cb1-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-503"><a href="#cb1-503" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_ann_filtered, <span class="st">"Decay"</span>)</span>
<span id="cb1-504"><a href="#cb1-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-505"><a href="#cb1-505" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-506"><a href="#cb1-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-507"><a href="#cb1-507" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método wrapper</span></span>
<span id="cb1-508"><a href="#cb1-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-509"><a href="#cb1-509" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-510"><a href="#cb1-510" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-511"><a href="#cb1-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-512"><a href="#cb1-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-513"><a href="#cb1-513" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/ann_wrapped.RData"</span>)</span>
<span id="cb1-514"><a href="#cb1-514" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_ann_filtered</span></span>
<span id="cb1-515"><a href="#cb1-515" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_ann_wrapped, <span class="st">"Auc"</span>)</span>
<span id="cb1-516"><a href="#cb1-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-517"><a href="#cb1-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-518"><a href="#cb1-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-519"><a href="#cb1-519" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Size</span></span>
<span id="cb1-520"><a href="#cb1-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-521"><a href="#cb1-521" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-522"><a href="#cb1-522" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_ann_wrapped, <span class="st">"Size"</span>)</span>
<span id="cb1-523"><a href="#cb1-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-524"><a href="#cb1-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-525"><a href="#cb1-525" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Decay</span></span>
<span id="cb1-526"><a href="#cb1-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-527"><a href="#cb1-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-528"><a href="#cb1-528" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_ann_wrapped, <span class="st">"Decay"</span>)</span>
<span id="cb1-529"><a href="#cb1-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-530"><a href="#cb1-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-531"><a href="#cb1-531" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb1-532"><a href="#cb1-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-533"><a href="#cb1-533" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-534"><a href="#cb1-534" aria-hidden="true" tabindex="-1"></a><span class="fu">frecuencia_variables</span>(tabla_ann_wrapped)</span>
<span id="cb1-535"><a href="#cb1-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-536"><a href="#cb1-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-537"><a href="#cb1-537" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-538"><a href="#cb1-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-539"><a href="#cb1-539" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método embedded</span></span>
<span id="cb1-540"><a href="#cb1-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-541"><a href="#cb1-541" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-542"><a href="#cb1-542" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-543"><a href="#cb1-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-544"><a href="#cb1-544" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-545"><a href="#cb1-545" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/ann_embedded.RData"</span>)</span>
<span id="cb1-546"><a href="#cb1-546" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_ann_filtered</span></span>
<span id="cb1-547"><a href="#cb1-547" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_ann_embedded, <span class="st">"Auc"</span>)</span>
<span id="cb1-548"><a href="#cb1-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-549"><a href="#cb1-549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-550"><a href="#cb1-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-551"><a href="#cb1-551" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Size</span></span>
<span id="cb1-552"><a href="#cb1-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-553"><a href="#cb1-553" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-554"><a href="#cb1-554" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_ann_embedded, <span class="st">"Size"</span>)</span>
<span id="cb1-555"><a href="#cb1-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-556"><a href="#cb1-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-557"><a href="#cb1-557" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Decay</span></span>
<span id="cb1-558"><a href="#cb1-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-559"><a href="#cb1-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-560"><a href="#cb1-560" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_ann_embedded, <span class="st">"Decay"</span>)</span>
<span id="cb1-561"><a href="#cb1-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-562"><a href="#cb1-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-563"><a href="#cb1-563" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb1-564"><a href="#cb1-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-565"><a href="#cb1-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-566"><a href="#cb1-566" aria-hidden="true" tabindex="-1"></a><span class="fu">frecuencia_variables</span>(tabla_ann_embedded)</span>
<span id="cb1-567"><a href="#cb1-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-568"><a href="#cb1-568" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-569"><a href="#cb1-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-570"><a href="#cb1-570" aria-hidden="true" tabindex="-1"></a>En términos de AUC, la red neuronal parece haber dado buenos resultados, estando la media más alta en 0.911, además de la robustez en la medida. Sobre el parámetro size, las distribuciones parecen inclinarse por un valor más bajo, entorno a las 16 neuronas. El parámetro decay, parece no ser robusto entre los distintos métodos de filtrado, aunque el rango de búsqueda ya estaba bastante acotado, por lo que no debería implicar un mayor problema.</span>
<span id="cb1-571"><a href="#cb1-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-572"><a href="#cb1-572" aria-hidden="true" tabindex="-1"></a>En la selección de variables, <span class="in">`F.DIAG`</span>, <span class="in">`ESTADIO`</span> parecen ser las que más aparece y son más importantes. Además de estas, también existen otras importantes como <span class="in">`CIRUGIA`</span>, <span class="in">`EDAD`</span>, <span class="in">`MENOP`</span> y <span class="in">`GANGLIOS`</span>.</span>
<span id="cb1-573"><a href="#cb1-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-574"><a href="#cb1-574" aria-hidden="true" tabindex="-1"></a><span class="fu">## Máquinas de soporte vectorial (SVM)</span></span>
<span id="cb1-575"><a href="#cb1-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-576"><a href="#cb1-576" aria-hidden="true" tabindex="-1"></a>Las máquinas de soporte vectorial son algoritmos que usan kernels para proyectar los datos de entrada en un espacio de características de mayor dimensión, donde son linealmente separables. El paquete usado con su implementación es <span class="in">`e1071`</span>.</span>
<span id="cb1-577"><a href="#cb1-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-578"><a href="#cb1-578" aria-hidden="true" tabindex="-1"></a>Hay tres hiperparámetros principales: kernel, coste y gamma. Sin embargo, gracias a la exploración inicial y el método de filtrado, se han acotado en gran medida los kernels posibles, siendo el mejor con diferencia el **kernel radial**. Además, se ha comprobado que el coste no afecta prácticamente al resultado, por lo que se ha fijado en 100.</span>
<span id="cb1-579"><a href="#cb1-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-580"><a href="#cb1-580" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Gamma**: controla el radio de influencia de los puntos de entrenamiento. Un gamma alto hace que el radio disminuya y el modelo se ajuste muy de cerca a los puntos de entrenamiento, lo que puede producir un modelo más complejo y sobreajuste. El rango de exploración es: 0.002, 0.005 y 0.008.</span>
<span id="cb1-581"><a href="#cb1-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-582"><a href="#cb1-582" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método de filtrado</span></span>
<span id="cb1-583"><a href="#cb1-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-584"><a href="#cb1-584" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-585"><a href="#cb1-585" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-586"><a href="#cb1-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-587"><a href="#cb1-587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-588"><a href="#cb1-588" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/svm_filtered.RData"</span>)</span>
<span id="cb1-589"><a href="#cb1-589" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_svm_filtered</span></span>
<span id="cb1-590"><a href="#cb1-590" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_svm_filtered, <span class="st">"Auc"</span>)</span>
<span id="cb1-591"><a href="#cb1-591" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-592"><a href="#cb1-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-593"><a href="#cb1-593" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gamma</span></span>
<span id="cb1-594"><a href="#cb1-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-595"><a href="#cb1-595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-596"><a href="#cb1-596" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_svm_filtered, <span class="st">"Gamma"</span>)</span>
<span id="cb1-597"><a href="#cb1-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-598"><a href="#cb1-598" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-599"><a href="#cb1-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-600"><a href="#cb1-600" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método wrapper</span></span>
<span id="cb1-601"><a href="#cb1-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-602"><a href="#cb1-602" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-603"><a href="#cb1-603" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-604"><a href="#cb1-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-605"><a href="#cb1-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-606"><a href="#cb1-606" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/svm_wrapped.RData"</span>)</span>
<span id="cb1-607"><a href="#cb1-607" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_svm_filtered</span></span>
<span id="cb1-608"><a href="#cb1-608" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_svm_wrapped, <span class="st">"Auc"</span>)</span>
<span id="cb1-609"><a href="#cb1-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-610"><a href="#cb1-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-611"><a href="#cb1-611" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gamma</span></span>
<span id="cb1-612"><a href="#cb1-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-613"><a href="#cb1-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-614"><a href="#cb1-614" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_svm_wrapped, <span class="st">"Gamma"</span>)</span>
<span id="cb1-615"><a href="#cb1-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-616"><a href="#cb1-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-617"><a href="#cb1-617" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb1-618"><a href="#cb1-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-619"><a href="#cb1-619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-620"><a href="#cb1-620" aria-hidden="true" tabindex="-1"></a><span class="fu">frecuencia_variables</span>(tabla_svm_wrapped)</span>
<span id="cb1-621"><a href="#cb1-621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-622"><a href="#cb1-622" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-623"><a href="#cb1-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-624"><a href="#cb1-624" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método embedded</span></span>
<span id="cb1-625"><a href="#cb1-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-626"><a href="#cb1-626" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-627"><a href="#cb1-627" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-628"><a href="#cb1-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-629"><a href="#cb1-629" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-630"><a href="#cb1-630" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/svm_embedded.RData"</span>)</span>
<span id="cb1-631"><a href="#cb1-631" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_svm_filtered</span></span>
<span id="cb1-632"><a href="#cb1-632" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_svm_embedded, <span class="st">"Auc"</span>)</span>
<span id="cb1-633"><a href="#cb1-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-634"><a href="#cb1-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-635"><a href="#cb1-635" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gamma</span></span>
<span id="cb1-636"><a href="#cb1-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-637"><a href="#cb1-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-638"><a href="#cb1-638" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_svm_embedded, <span class="st">"Gamma"</span>)</span>
<span id="cb1-639"><a href="#cb1-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-640"><a href="#cb1-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-641"><a href="#cb1-641" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb1-642"><a href="#cb1-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-643"><a href="#cb1-643" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-644"><a href="#cb1-644" aria-hidden="true" tabindex="-1"></a><span class="fu">frecuencia_variables</span>(tabla_svm_embedded)</span>
<span id="cb1-645"><a href="#cb1-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-646"><a href="#cb1-646" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-647"><a href="#cb1-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-648"><a href="#cb1-648" aria-hidden="true" tabindex="-1"></a>El AUC ha dado buenos resultados en términos de robustez y la media más alta es de 0.881. Sin embargo el hiperparámetro gamma no goza de esta robustez, aunque al estar el rango bastante acotado no debería ser problemático. En cuanto a las variables, las más comunes vuelven a ser <span class="in">`F.DIAG`</span> y <span class="in">`ESTADIO`</span>; además se encuentran <span class="in">`CIRUGIA`</span>, <span class="in">`EDAD`</span>, <span class="in">`MENOP`</span>, <span class="in">`GANGLIOS`</span>, <span class="in">`RP`</span> y <span class="in">`KI67`</span>.</span>
<span id="cb1-649"><a href="#cb1-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-650"><a href="#cb1-650" aria-hidden="true" tabindex="-1"></a>En general ha resultado ser un modelo con una robustez decente y un conjunto de variables que se encuentran entre lo esperado.</span>
<span id="cb1-651"><a href="#cb1-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-652"><a href="#cb1-652" aria-hidden="true" tabindex="-1"></a><span class="fu">## Árbol de decisión</span></span>
<span id="cb1-653"><a href="#cb1-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-654"><a href="#cb1-654" aria-hidden="true" tabindex="-1"></a>Los árboles de decisión dividen los datos en subconjuntos más pequeños basándose en los valores de las características, hasta que cada subconunto es homogéneo o contiene el mismo valor de resultado. Cada nodo en el árbol representa una característica, mientras que cada rama representa un valor de esa característica. El paquete usado es <span class="in">`rpart`</span>. Hay un único hiperparámetro a ajustar:</span>
<span id="cb1-655"><a href="#cb1-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-656"><a href="#cb1-656" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Cp**: nivel de poda del árbol. Un valor de 1 se corresponde con un árbol sin divisiones, y un valor de 0 con uno de profundidad máxima.</span>
<span id="cb1-657"><a href="#cb1-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-658"><a href="#cb1-658" aria-hidden="true" tabindex="-1"></a>El rango de búsqueda de parámetros ha sido ajustado a 0.01 y 0.005. No obstante y no debido a un error en el código, para los tres métodos y para todos los folds, el mejor valor es siempre 0.01, por lo que se limitará a la discusión del AUC y las variables. Esto se debe a que parece que hay un umbral en el hiperparámetro a partir del cual el AUC no mejora, el cual gracias a la exploración inicial, se ha determinado que es 0.01.</span>
<span id="cb1-659"><a href="#cb1-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-660"><a href="#cb1-660" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método de filtrado</span></span>
<span id="cb1-661"><a href="#cb1-661" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-662"><a href="#cb1-662" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-663"><a href="#cb1-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-664"><a href="#cb1-664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-665"><a href="#cb1-665" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/dt_filtered.RData"</span>)</span>
<span id="cb1-666"><a href="#cb1-666" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_dt_filtered</span></span>
<span id="cb1-667"><a href="#cb1-667" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_dt_filtered, <span class="st">"Auc"</span>)</span>
<span id="cb1-668"><a href="#cb1-668" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-669"><a href="#cb1-669" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-670"><a href="#cb1-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-671"><a href="#cb1-671" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método wrapper</span></span>
<span id="cb1-672"><a href="#cb1-672" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-673"><a href="#cb1-673" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-674"><a href="#cb1-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-675"><a href="#cb1-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-676"><a href="#cb1-676" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/dt_wrapped.RData"</span>)</span>
<span id="cb1-677"><a href="#cb1-677" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_dt_wrapped, <span class="st">"Auc"</span>)</span>
<span id="cb1-678"><a href="#cb1-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-679"><a href="#cb1-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-680"><a href="#cb1-680" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb1-681"><a href="#cb1-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-682"><a href="#cb1-682" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-683"><a href="#cb1-683" aria-hidden="true" tabindex="-1"></a><span class="fu">frecuencia_variables</span>(tabla_dt_wrapped)</span>
<span id="cb1-684"><a href="#cb1-684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-685"><a href="#cb1-685" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-686"><a href="#cb1-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-687"><a href="#cb1-687" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método embedded</span></span>
<span id="cb1-688"><a href="#cb1-688" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-689"><a href="#cb1-689" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-690"><a href="#cb1-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-691"><a href="#cb1-691" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-692"><a href="#cb1-692" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/dt_embedded.RData"</span>)</span>
<span id="cb1-693"><a href="#cb1-693" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_dt_embedded, <span class="st">"Auc"</span>)</span>
<span id="cb1-694"><a href="#cb1-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-695"><a href="#cb1-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-696"><a href="#cb1-696" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb1-697"><a href="#cb1-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-698"><a href="#cb1-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-699"><a href="#cb1-699" aria-hidden="true" tabindex="-1"></a><span class="fu">frecuencia_variables</span>(tabla_dt_embedded)</span>
<span id="cb1-700"><a href="#cb1-700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-701"><a href="#cb1-701" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-702"><a href="#cb1-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-703"><a href="#cb1-703" aria-hidden="true" tabindex="-1"></a>Este modelo parece no haber dado tan buenos resultados de AUC, solamente en el método wrapper, donde además es robusto. El método embedded ha dado una media de 0.5 de AUC, lo cual es un resultado pésimo y al final del informe se comentará porque este método a veces no ha funcionado bien en el estudio.</span>
<span id="cb1-704"><a href="#cb1-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-705"><a href="#cb1-705" aria-hidden="true" tabindex="-1"></a>Dadas estas condiciones, las variables, las cuales no son robustas entre los métodos, que se seleccionaría sería las elegidas en el método wrapper, las cuales son todas. A pesar de haber dado buenos resultados con este método, no ha resultado ser un modelo robusto, por lo que se recomendaría el uso de otros modelos.</span>
<span id="cb1-706"><a href="#cb1-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-707"><a href="#cb1-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-708"><a href="#cb1-708" aria-hidden="true" tabindex="-1"></a><span class="fu">## KNN (Vecinos más cercanos)</span></span>
<span id="cb1-709"><a href="#cb1-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-710"><a href="#cb1-710" aria-hidden="true" tabindex="-1"></a>Este algoritmo funciona identificando los k vecinos más cercanos a una nueva instancia, según una métrica de distancia. La clase mayoritaria entre esos puntos será la predicción. El paquete que lo implementa es <span class="in">`class`</span> y con la opción *prob = true* se devuelve la probabilidad. El único parámetro a ajustar es el siguiente:</span>
<span id="cb1-711"><a href="#cb1-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-712"><a href="#cb1-712" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**K**: número de vecinos más cercanos. Ya que el problema es de clasificación binaria, se elegirán números impares para las pruebas, ya que elimina la posibilidad de empate.</span>
<span id="cb1-713"><a href="#cb1-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-714"><a href="#cb1-714" aria-hidden="true" tabindex="-1"></a>Una vez más, gracias a la exploración inicial y los métodos de filtrado, el espacio de búsqueda se ha reducido a: 23, 26, 29 y 32. Cabe destacar, que es necesario codificar con one-hot-encoding y escalar las variables numéricas para que el modelo pueda aceptar los datos.</span>
<span id="cb1-715"><a href="#cb1-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-716"><a href="#cb1-716" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método de filtrado</span></span>
<span id="cb1-717"><a href="#cb1-717" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-718"><a href="#cb1-718" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-719"><a href="#cb1-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-720"><a href="#cb1-720" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-721"><a href="#cb1-721" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/knn_filtered.RData"</span>)</span>
<span id="cb1-722"><a href="#cb1-722" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_knn_filtered</span></span>
<span id="cb1-723"><a href="#cb1-723" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_knn_filtered, <span class="st">"Auc"</span>)</span>
<span id="cb1-724"><a href="#cb1-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-725"><a href="#cb1-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-726"><a href="#cb1-726" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K</span></span>
<span id="cb1-727"><a href="#cb1-727" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-728"><a href="#cb1-728" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_knn_filtered, <span class="st">"K"</span>)</span>
<span id="cb1-729"><a href="#cb1-729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-730"><a href="#cb1-730" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-731"><a href="#cb1-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-732"><a href="#cb1-732" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método wrapper</span></span>
<span id="cb1-733"><a href="#cb1-733" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-734"><a href="#cb1-734" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-735"><a href="#cb1-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-736"><a href="#cb1-736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-737"><a href="#cb1-737" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/knn_wrapped.RData"</span>)</span>
<span id="cb1-738"><a href="#cb1-738" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_knn_wrapped, <span class="st">"Auc"</span>)</span>
<span id="cb1-739"><a href="#cb1-739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-740"><a href="#cb1-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-741"><a href="#cb1-741" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K</span></span>
<span id="cb1-742"><a href="#cb1-742" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-743"><a href="#cb1-743" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_knn_wrapped, <span class="st">"K"</span>)</span>
<span id="cb1-744"><a href="#cb1-744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-745"><a href="#cb1-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-746"><a href="#cb1-746" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb1-747"><a href="#cb1-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-748"><a href="#cb1-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-749"><a href="#cb1-749" aria-hidden="true" tabindex="-1"></a><span class="fu">frecuencia_variables</span>(tabla_knn_wrapped)</span>
<span id="cb1-750"><a href="#cb1-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-751"><a href="#cb1-751" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-752"><a href="#cb1-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-753"><a href="#cb1-753" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método embedded</span></span>
<span id="cb1-754"><a href="#cb1-754" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-755"><a href="#cb1-755" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-756"><a href="#cb1-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-757"><a href="#cb1-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-758"><a href="#cb1-758" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/knn_embedded.RData"</span>)</span>
<span id="cb1-759"><a href="#cb1-759" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_knn_embedded, <span class="st">"Auc"</span>)</span>
<span id="cb1-760"><a href="#cb1-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-761"><a href="#cb1-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-762"><a href="#cb1-762" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K</span></span>
<span id="cb1-763"><a href="#cb1-763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-764"><a href="#cb1-764" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_knn_embedded, <span class="st">"K"</span>)</span>
<span id="cb1-765"><a href="#cb1-765" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-766"><a href="#cb1-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-767"><a href="#cb1-767" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb1-768"><a href="#cb1-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-769"><a href="#cb1-769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-770"><a href="#cb1-770" aria-hidden="true" tabindex="-1"></a><span class="fu">frecuencia_variables</span>(tabla_knn_embedded)</span>
<span id="cb1-771"><a href="#cb1-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-772"><a href="#cb1-772" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-773"><a href="#cb1-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-774"><a href="#cb1-774" aria-hidden="true" tabindex="-1"></a>El KNN ha sido hasta el momento el modelo que mejor AUC medio ha dado, estando el más alto en 0.945, presentando además robustez en la medida. Además es un modelo sencillo, que solo consta de un hiperparámetro y se encuentra en torno a 29 su mejor valor. Las variables que más veces han salido teniendo en cuenta los tres métodos son: <span class="in">`F.DIAG`</span>, <span class="in">`ESTADIO`</span>, <span class="in">`HER2`</span>, <span class="in">`CIRUGIA`</span>, <span class="in">`MENOP`</span>, <span class="in">`GANGLIOS`</span> y <span class="in">`FENOTIPO`</span>.</span>
<span id="cb1-775"><a href="#cb1-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-776"><a href="#cb1-776" aria-hidden="true" tabindex="-1"></a>En general ha sido un modelo con muy buenos resultados, que junto a su simpleza, hace que sea un modelo potencialmente favorito como modelo final.</span>
<span id="cb1-777"><a href="#cb1-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-778"><a href="#cb1-778" aria-hidden="true" tabindex="-1"></a><span class="fu">## Naive Bayes</span></span>
<span id="cb1-779"><a href="#cb1-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-780"><a href="#cb1-780" aria-hidden="true" tabindex="-1"></a>Naive Bayes es un clasificador probabilístico basado en el teorema de Bayes. Calcula la probabilidad a priori de cada clase en el conjunto de datos y y evalúa la verosimilitud de que cada variable aparezca en una clase determinada. Por último calcula la probabilidad a posteriori. Este modelo no tiene hiperparámetros, así que lo único que se evaluará es el AUC y las variables. El paquete usado es <span class="in">`e1071`</span>.</span>
<span id="cb1-781"><a href="#cb1-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-782"><a href="#cb1-782" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método de filtrado</span></span>
<span id="cb1-783"><a href="#cb1-783" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-784"><a href="#cb1-784" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-785"><a href="#cb1-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-786"><a href="#cb1-786" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-787"><a href="#cb1-787" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/nb_filtered.RData"</span>)</span>
<span id="cb1-788"><a href="#cb1-788" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_knn_filtered</span></span>
<span id="cb1-789"><a href="#cb1-789" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_nb_filtered, <span class="st">"Auc"</span>)</span>
<span id="cb1-790"><a href="#cb1-790" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-791"><a href="#cb1-791" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-792"><a href="#cb1-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-793"><a href="#cb1-793" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método wrapper</span></span>
<span id="cb1-794"><a href="#cb1-794" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-795"><a href="#cb1-795" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-796"><a href="#cb1-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-797"><a href="#cb1-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-798"><a href="#cb1-798" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/nb_wrapped.RData"</span>)</span>
<span id="cb1-799"><a href="#cb1-799" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_nb_wrapped, <span class="st">"Auc"</span>)</span>
<span id="cb1-800"><a href="#cb1-800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-801"><a href="#cb1-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-802"><a href="#cb1-802" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb1-803"><a href="#cb1-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-804"><a href="#cb1-804" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-805"><a href="#cb1-805" aria-hidden="true" tabindex="-1"></a><span class="fu">frecuencia_variables</span>(tabla_nb_wrapped)</span>
<span id="cb1-806"><a href="#cb1-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-807"><a href="#cb1-807" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-808"><a href="#cb1-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-809"><a href="#cb1-809" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método embedded</span></span>
<span id="cb1-810"><a href="#cb1-810" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-811"><a href="#cb1-811" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-812"><a href="#cb1-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-813"><a href="#cb1-813" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-814"><a href="#cb1-814" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/nb_embedded.RData"</span>)</span>
<span id="cb1-815"><a href="#cb1-815" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_nb_embedded, <span class="st">"Auc"</span>)</span>
<span id="cb1-816"><a href="#cb1-816" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-817"><a href="#cb1-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-818"><a href="#cb1-818" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb1-819"><a href="#cb1-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-820"><a href="#cb1-820" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-821"><a href="#cb1-821" aria-hidden="true" tabindex="-1"></a><span class="fu">frecuencia_variables</span>(tabla_nb_embedded)</span>
<span id="cb1-822"><a href="#cb1-822" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-823"><a href="#cb1-823" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-824"><a href="#cb1-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-825"><a href="#cb1-825" aria-hidden="true" tabindex="-1"></a>Sorprendentemente, este modelo a pesar del gran desbalanceo de datos en la variable de estudio, ha logrado unos AUC similares a otros modelos, siendo la media más alta 0.869. Naive Bayes suele ser un modelo que predice la clase mayoritaria en caso de haber clases desbalanceadas, por lo que teóricamente no es el más indicado. No obstante, las variables también mantienen una robustez y se encuentran entre las mayoritarias las más comunes: <span class="in">`F.DIAG`</span>, <span class="in">`ESTADIO`</span>,<span class="in">`CIRUGIA`</span>, <span class="in">`TAM`</span>, <span class="in">`EDAD_DCO`</span> y <span class="in">`RE`</span>.</span>
<span id="cb1-826"><a href="#cb1-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-827"><a href="#cb1-827" aria-hidden="true" tabindex="-1"></a><span class="fu">## Random forest</span></span>
<span id="cb1-828"><a href="#cb1-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-829"><a href="#cb1-829" aria-hidden="true" tabindex="-1"></a>Random forest construye múltiples árboles de decisión durante el entrenamiento. La predicción final se determina mediante un voto mayoritario entre todas las predicciones de los árboles individuales. En otras palabras, se combinan distintos modelos débiles en uno fuerte, reduciendo así el riesgo de sobreajuste. El paquete usado es <span class="in">`randomForest`</span> y los parámetros a ajustar son:</span>
<span id="cb1-830"><a href="#cb1-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-831"><a href="#cb1-831" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Ntree**: indica el número de árboles que se construirán en el modelo.</span>
<span id="cb1-832"><a href="#cb1-832" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Maxnodes**: establece el número máximo de hojas permitidos en cada uno de los árboles.</span>
<span id="cb1-833"><a href="#cb1-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-834"><a href="#cb1-834" aria-hidden="true" tabindex="-1"></a>Tras la exploración inicial, es espacio de búsqueda es el siguiente:</span>
<span id="cb1-835"><a href="#cb1-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-836"><a href="#cb1-836" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Ntree**: 55, 65</span>
<span id="cb1-837"><a href="#cb1-837" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Maxnodes**: 55, 65</span>
<span id="cb1-838"><a href="#cb1-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-839"><a href="#cb1-839" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método de filtrado</span></span>
<span id="cb1-840"><a href="#cb1-840" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-841"><a href="#cb1-841" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-842"><a href="#cb1-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-843"><a href="#cb1-843" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-844"><a href="#cb1-844" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/rf_filtered.RData"</span>)</span>
<span id="cb1-845"><a href="#cb1-845" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_rf_filtered</span></span>
<span id="cb1-846"><a href="#cb1-846" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_rf_filtered, <span class="st">"Auc"</span>)</span>
<span id="cb1-847"><a href="#cb1-847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-848"><a href="#cb1-848" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ntree</span></span>
<span id="cb1-849"><a href="#cb1-849" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-850"><a href="#cb1-850" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_rf_filtered, <span class="st">"Ntree"</span>)</span>
<span id="cb1-851"><a href="#cb1-851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-852"><a href="#cb1-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-853"><a href="#cb1-853" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Maxnodes</span></span>
<span id="cb1-854"><a href="#cb1-854" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-855"><a href="#cb1-855" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_rf_filtered, <span class="st">"Maxnodes"</span>)</span>
<span id="cb1-856"><a href="#cb1-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-857"><a href="#cb1-857" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-858"><a href="#cb1-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-859"><a href="#cb1-859" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método wrapper</span></span>
<span id="cb1-860"><a href="#cb1-860" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-861"><a href="#cb1-861" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-862"><a href="#cb1-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-863"><a href="#cb1-863" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-864"><a href="#cb1-864" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/rf_wrapped.RData"</span>)</span>
<span id="cb1-865"><a href="#cb1-865" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_rf_filtered</span></span>
<span id="cb1-866"><a href="#cb1-866" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_rf_wrapped, <span class="st">"Auc"</span>)</span>
<span id="cb1-867"><a href="#cb1-867" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-868"><a href="#cb1-868" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ntree</span></span>
<span id="cb1-869"><a href="#cb1-869" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-870"><a href="#cb1-870" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_rf_wrapped, <span class="st">"Ntree"</span>)</span>
<span id="cb1-871"><a href="#cb1-871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-872"><a href="#cb1-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-873"><a href="#cb1-873" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Maxnodes</span></span>
<span id="cb1-874"><a href="#cb1-874" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-875"><a href="#cb1-875" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_rf_wrapped, <span class="st">"Maxnodes"</span>)</span>
<span id="cb1-876"><a href="#cb1-876" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-877"><a href="#cb1-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-878"><a href="#cb1-878" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb1-879"><a href="#cb1-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-880"><a href="#cb1-880" aria-hidden="true" tabindex="-1"></a><span class="fu">frecuencia_variables</span>(tabla_rf_wrapped)</span>
<span id="cb1-881"><a href="#cb1-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-882"><a href="#cb1-882" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-883"><a href="#cb1-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-884"><a href="#cb1-884" aria-hidden="true" tabindex="-1"></a><span class="fu">### Método embedded</span></span>
<span id="cb1-885"><a href="#cb1-885" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-886"><a href="#cb1-886" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-887"><a href="#cb1-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-888"><a href="#cb1-888" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-889"><a href="#cb1-889" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/rf_embedded.RData"</span>)</span>
<span id="cb1-890"><a href="#cb1-890" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_rf_filtered</span></span>
<span id="cb1-891"><a href="#cb1-891" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_rf_embedded, <span class="st">"Auc"</span>)</span>
<span id="cb1-892"><a href="#cb1-892" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-893"><a href="#cb1-893" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ntree</span></span>
<span id="cb1-894"><a href="#cb1-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-895"><a href="#cb1-895" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_rf_embedded, <span class="st">"Ntree"</span>)</span>
<span id="cb1-896"><a href="#cb1-896" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-897"><a href="#cb1-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-898"><a href="#cb1-898" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Maxnodes</span></span>
<span id="cb1-899"><a href="#cb1-899" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-900"><a href="#cb1-900" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_rf_embedded, <span class="st">"Maxnodes"</span>)</span>
<span id="cb1-901"><a href="#cb1-901" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-902"><a href="#cb1-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-903"><a href="#cb1-903" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb1-904"><a href="#cb1-904" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-905"><a href="#cb1-905" aria-hidden="true" tabindex="-1"></a><span class="fu">frecuencia_variables</span>(tabla_rf_embedded)</span>
<span id="cb1-906"><a href="#cb1-906" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-907"><a href="#cb1-907" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-908"><a href="#cb1-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-909"><a href="#cb1-909" aria-hidden="true" tabindex="-1"></a>El AUC parece no ser tan robusto como en otros modelos, además de tener un valor más bajo, siendo la media más alta de 0.812 y dando el método embedded valores incluso por debajo de 0.5. Para el hiperparámetro Ntree, parece no haber tampoco un consenso, aunque la moda es 55 en los tres métodos. Tampoco parece haberlo para Maxnodes, aunque esta vez la moda difiere entre los métodos.</span>
<span id="cb1-910"><a href="#cb1-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-911"><a href="#cb1-911" aria-hidden="true" tabindex="-1"></a>De acuerdo con las variables, parece ser menos clara la decisión respecto a otros modelos. Las más frecuentes en el método embedded son <span class="in">`F.DIAG`</span>, <span class="in">`ESTADIO`</span>,<span class="in">`CIRUGIA`</span>, mientras que según el método wrapper, prácticamente o  todas las variables son relevantes para el modelo.</span>
<span id="cb1-912"><a href="#cb1-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-913"><a href="#cb1-913" aria-hidden="true" tabindex="-1"></a>Resumiendo, no es el modelo más robusto, ni en métricas ni en variables, a parte de no encontrarse entre los de mejor rendimiento, por lo que probablemente no sea la mejor opción.</span>
<span id="cb1-914"><a href="#cb1-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-915"><a href="#cb1-915" aria-hidden="true" tabindex="-1"></a><span class="fu">## Adaboost</span></span>
<span id="cb1-916"><a href="#cb1-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-917"><a href="#cb1-917" aria-hidden="true" tabindex="-1"></a>El algoritmo AdaBoost funciona entrenando secuencialmente una serie de modelos débiles, donde cada uno se enfoca más en los casos que fueron mal clasificados por los modelos anteriores. Finalmente, se combinan los modelos en un modelo fuerte mediante un voto ponderado. El paquete usado es <span class="in">`adabag`</span>, y el parámetro ajustado es **Mfinal**, que indica el número de iteraciones para el proceso de boosting.</span>
<span id="cb1-918"><a href="#cb1-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-919"><a href="#cb1-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-920"><a href="#cb1-920" aria-hidden="true" tabindex="-1"></a><span class="fu">### Filtrado</span></span>
<span id="cb1-921"><a href="#cb1-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-922"><a href="#cb1-922" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb1-923"><a href="#cb1-923" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AUC</span></span>
<span id="cb1-924"><a href="#cb1-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-925"><a href="#cb1-925" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-926"><a href="#cb1-926" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"resultados/ab_filtered.RData"</span>)</span>
<span id="cb1-927"><a href="#cb1-927" aria-hidden="true" tabindex="-1"></a><span class="co">#tabla_ab_filtered</span></span>
<span id="cb1-928"><a href="#cb1-928" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_ab_filtered, <span class="st">"Auc"</span>)</span>
<span id="cb1-929"><a href="#cb1-929" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-930"><a href="#cb1-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-931"><a href="#cb1-931" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mfinal</span></span>
<span id="cb1-932"><a href="#cb1-932" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-933"><a href="#cb1-933" aria-hidden="true" tabindex="-1"></a><span class="fu">visualizar.distribucion</span>(tabla_ab_filtered, <span class="st">"Mfinal"</span>)</span>
<span id="cb1-934"><a href="#cb1-934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-935"><a href="#cb1-935" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-936"><a href="#cb1-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-937"><a href="#cb1-937" aria-hidden="true" tabindex="-1"></a>El **AUC** parece ser robusto y muestra un valor decente de 0.888. Sin embargo, en el hiperparámetro <span class="in">`MFinal`</span> parece no haber un consenso, por lo que se cogería 80 como valor en un modelo final. </span>
<span id="cb1-938"><a href="#cb1-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-939"><a href="#cb1-939" aria-hidden="true" tabindex="-1"></a>Los otros dos métodos no se muestran por un problema en la ejecución. Estos se ejecutaban infinitamente y no acababan a pesar de ser pacientes a la espera de resultados.</span>
<span id="cb1-940"><a href="#cb1-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-941"><a href="#cb1-941" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparación de los métodos de selección de variables</span></span>
<span id="cb1-942"><a href="#cb1-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-943"><a href="#cb1-943" aria-hidden="true" tabindex="-1"></a>Los distintos algoritmos de selección de variables que se han usado en este informe, presentan diferencias a tener en cuenta. Sin embargo, estos pueden complementarse, siendo la mejor opción siempre que se tengan los recursos suficientes, usar los tres métodos para ver la robustez del modelo.</span>
<span id="cb1-944"><a href="#cb1-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-945"><a href="#cb1-945" aria-hidden="true" tabindex="-1"></a>El flujo seguido en la realización de este proyecto, ha sido el del ajuste inicial de parámetros usando el método de filtrado, ya que es muy rápido en ejecutarse. Además se ha podido observar que las variables elegidas según este criterio se corresponden en gran medida con las de los otros dos métodos de selección, que en teoría son "más precisos".</span>
<span id="cb1-946"><a href="#cb1-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-947"><a href="#cb1-947" aria-hidden="true" tabindex="-1"></a>El método wrapper da buenos resultados, pero el tiempo de cómputo se dispara. En cuanto al método embedded, también ha dado buenos resultados en regla general y es considerablemente más rápido que el wrapper. Sin embargo, en su ejecución se lanzaba un aviso, advirtiendo del bajo número de datos para algunas clases debido al desbalanceo del conjunto de datos. Esto ha producido en algunos modelos un rendimiento mucho peor en este método, debido a problemas de generalización e inestabilidad.</span>
<span id="cb1-948"><a href="#cb1-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-949"><a href="#cb1-949" aria-hidden="true" tabindex="-1"></a><span class="fu"># Modelo final</span></span>
<span id="cb1-950"><a href="#cb1-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-951"><a href="#cb1-951" aria-hidden="true" tabindex="-1"></a>El mejor modelo según el parámetro **AUC** es el KNN, con un mejor AUC medio de 0.945. Sin embargo, ANN tiene un mejor AUC de 0.911, pero su media de todos los métodos de filtrado de variables es mayor, por lo que se elegirá ANN como modelo final por su excelente rendimiento y robustez.</span>
<span id="cb1-952"><a href="#cb1-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-953"><a href="#cb1-953" aria-hidden="true" tabindex="-1"></a>Se han vuelto a sacar las métricas usando el double cross validation, pero esta vez con los hiperparámetros y variables finales. De esta manera se obtienen unas métricas finales lo más robustas y fiables posibles. Los parámetros finales son:</span>
<span id="cb1-954"><a href="#cb1-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-955"><a href="#cb1-955" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Size**: 16</span>
<span id="cb1-956"><a href="#cb1-956" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Decay**: 0.2</span>
<span id="cb1-957"><a href="#cb1-957" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Variables**: ESTADIO, F.DIAG, RE y TAM</span>
<span id="cb1-958"><a href="#cb1-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-959"><a href="#cb1-959" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb1-960"><a href="#cb1-960" aria-hidden="true" tabindex="-1"></a>cv5x2_ann <span class="ot">&lt;-</span> <span class="cf">function</span>(df_o, variable_estudio, <span class="at">neuronas =</span> <span class="dv">16</span>, <span class="at">decay =</span> <span class="fl">0.2</span>) {</span>
<span id="cb1-961"><a href="#cb1-961" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df_o[<span class="fu">c</span>(<span class="st">"ESTADIO"</span>, <span class="st">"F.DIAG"</span>, <span class="st">"RE"</span>, <span class="st">"TAM"</span>, <span class="st">"ESTADO_ACTUAL"</span>)]</span>
<span id="cb1-962"><a href="#cb1-962" aria-hidden="true" tabindex="-1"></a>  semillas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">13</span>, <span class="dv">25</span>, <span class="dv">39</span>)</span>
<span id="cb1-963"><a href="#cb1-963" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-964"><a href="#cb1-964" aria-hidden="true" tabindex="-1"></a>  AUC <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb1-965"><a href="#cb1-965" aria-hidden="true" tabindex="-1"></a>  PRECISION <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb1-966"><a href="#cb1-966" aria-hidden="true" tabindex="-1"></a>  RECALL <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb1-967"><a href="#cb1-967" aria-hidden="true" tabindex="-1"></a>  F1_SCORE <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb1-968"><a href="#cb1-968" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-969"><a href="#cb1-969" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(semilla <span class="cf">in</span> semillas) {</span>
<span id="cb1-970"><a href="#cb1-970" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(semilla)</span>
<span id="cb1-971"><a href="#cb1-971" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-972"><a href="#cb1-972" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Crear las cajas de test y entrenamiento para el outer-loop</span></span>
<span id="cb1-973"><a href="#cb1-973" aria-hidden="true" tabindex="-1"></a>    folds_outer <span class="ot">&lt;-</span> <span class="fu">createFolds</span>(df[[variable_estudio]], <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb1-974"><a href="#cb1-974" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-975"><a href="#cb1-975" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Realizar la validación cruzada 5x2</span></span>
<span id="cb1-976"><a href="#cb1-976" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Outer-loop</span></span>
<span id="cb1-977"><a href="#cb1-977" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb1-978"><a href="#cb1-978" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Crear las cajas de validación y entrenamiento para el inner-loop</span></span>
<span id="cb1-979"><a href="#cb1-979" aria-hidden="true" tabindex="-1"></a>      folds_inner <span class="ot">&lt;-</span> folds_outer[<span class="sc">-</span>i]</span>
<span id="cb1-980"><a href="#cb1-980" aria-hidden="true" tabindex="-1"></a>      datos_test <span class="ot">&lt;-</span> df[<span class="fu">unlist</span>(folds_outer[i]),]</span>
<span id="cb1-981"><a href="#cb1-981" aria-hidden="true" tabindex="-1"></a>      datos_inner <span class="ot">&lt;-</span> df[<span class="fu">unlist</span>(folds_inner),]</span>
<span id="cb1-982"><a href="#cb1-982" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-983"><a href="#cb1-983" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Entrenar el modelo ANN</span></span>
<span id="cb1-984"><a href="#cb1-984" aria-hidden="true" tabindex="-1"></a>      modelo_ann <span class="ot">&lt;-</span> <span class="fu">nnet</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(variable_estudio, <span class="st">"~ ."</span>)),</span>
<span id="cb1-985"><a href="#cb1-985" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> datos_inner,</span>
<span id="cb1-986"><a href="#cb1-986" aria-hidden="true" tabindex="-1"></a>                         <span class="at">size =</span> neuronas,</span>
<span id="cb1-987"><a href="#cb1-987" aria-hidden="true" tabindex="-1"></a>                         <span class="at">decay =</span> decay,</span>
<span id="cb1-988"><a href="#cb1-988" aria-hidden="true" tabindex="-1"></a>                         <span class="at">maxit =</span> <span class="dv">100</span>,</span>
<span id="cb1-989"><a href="#cb1-989" aria-hidden="true" tabindex="-1"></a>                         <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-990"><a href="#cb1-990" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-991"><a href="#cb1-991" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Predecir probabilidades</span></span>
<span id="cb1-992"><a href="#cb1-992" aria-hidden="true" tabindex="-1"></a>      probabilidades_ann <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_ann, datos_test, <span class="at">type =</span> <span class="st">"raw"</span>)</span>
<span id="cb1-993"><a href="#cb1-993" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-994"><a href="#cb1-994" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calcular AUC</span></span>
<span id="cb1-995"><a href="#cb1-995" aria-hidden="true" tabindex="-1"></a>      auc_modelo <span class="ot">&lt;-</span> <span class="fu">auc</span>(<span class="fu">roc</span>(datos_test[[variable_estudio]], probabilidades_ann))</span>
<span id="cb1-996"><a href="#cb1-996" aria-hidden="true" tabindex="-1"></a>      AUC <span class="ot">&lt;-</span> <span class="fu">c</span>(AUC, auc_modelo)</span>
<span id="cb1-997"><a href="#cb1-997" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-998"><a href="#cb1-998" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calcular Predicciones y Matriz de Confusión</span></span>
<span id="cb1-999"><a href="#cb1-999" aria-hidden="true" tabindex="-1"></a>      predicciones <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(probabilidades_ann <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb1-1000"><a href="#cb1-1000" aria-hidden="true" tabindex="-1"></a>      matriz_confusion <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(<span class="fu">factor</span>(predicciones), <span class="fu">factor</span>(datos_test[[variable_estudio]]))</span>
<span id="cb1-1001"><a href="#cb1-1001" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-1002"><a href="#cb1-1002" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calcular precisión, recall y F1-score</span></span>
<span id="cb1-1003"><a href="#cb1-1003" aria-hidden="true" tabindex="-1"></a>      precision <span class="ot">&lt;-</span> matriz_confusion<span class="sc">$</span>byClass[<span class="st">"Pos Pred Value"</span>]</span>
<span id="cb1-1004"><a href="#cb1-1004" aria-hidden="true" tabindex="-1"></a>      recall <span class="ot">&lt;-</span> matriz_confusion<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>]</span>
<span id="cb1-1005"><a href="#cb1-1005" aria-hidden="true" tabindex="-1"></a>      f1_score <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (precision <span class="sc">*</span> recall) <span class="sc">/</span> (precision <span class="sc">+</span> recall)</span>
<span id="cb1-1006"><a href="#cb1-1006" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-1007"><a href="#cb1-1007" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Almacenar métricas</span></span>
<span id="cb1-1008"><a href="#cb1-1008" aria-hidden="true" tabindex="-1"></a>      PRECISION <span class="ot">&lt;-</span> <span class="fu">c</span>(PRECISION, precision)</span>
<span id="cb1-1009"><a href="#cb1-1009" aria-hidden="true" tabindex="-1"></a>      RECALL <span class="ot">&lt;-</span> <span class="fu">c</span>(RECALL, recall)</span>
<span id="cb1-1010"><a href="#cb1-1010" aria-hidden="true" tabindex="-1"></a>      F1_SCORE <span class="ot">&lt;-</span> <span class="fu">c</span>(F1_SCORE, f1_score)</span>
<span id="cb1-1011"><a href="#cb1-1011" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-1012"><a href="#cb1-1012" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-1013"><a href="#cb1-1013" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1014"><a href="#cb1-1014" aria-hidden="true" tabindex="-1"></a>  metricas <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">AUC =</span> AUC, <span class="at">Precision =</span> PRECISION, <span class="at">Recall =</span> RECALL, <span class="at">F1_Score =</span> F1_SCORE)</span>
<span id="cb1-1015"><a href="#cb1-1015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(metricas)</span>
<span id="cb1-1016"><a href="#cb1-1016" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-1017"><a href="#cb1-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1018"><a href="#cb1-1018" aria-hidden="true" tabindex="-1"></a>metricas <span class="ot">&lt;-</span> <span class="fu">cv5x2_ann</span>(df, <span class="st">"ESTADO_ACTUAL"</span>)</span>
<span id="cb1-1019"><a href="#cb1-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1020"><a href="#cb1-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1021"><a href="#cb1-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1022"><a href="#cb1-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb1-1023"><a href="#cb1-1023" aria-hidden="true" tabindex="-1"></a>metricas_medias <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-1024"><a href="#cb1-1024" aria-hidden="true" tabindex="-1"></a>  <span class="at">AUC =</span> <span class="fu">mean</span>(metricas<span class="sc">$</span>AUC, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-1025"><a href="#cb1-1025" aria-hidden="true" tabindex="-1"></a>  <span class="at">Precision =</span> <span class="fu">mean</span>(metricas<span class="sc">$</span>Precision, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-1026"><a href="#cb1-1026" aria-hidden="true" tabindex="-1"></a>  <span class="at">Recall =</span> <span class="fu">mean</span>(metricas<span class="sc">$</span>Recall, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-1027"><a href="#cb1-1027" aria-hidden="true" tabindex="-1"></a>  <span class="at">F1_Score =</span> <span class="fu">mean</span>(metricas<span class="sc">$</span>F1_Score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-1028"><a href="#cb1-1028" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-1029"><a href="#cb1-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1030"><a href="#cb1-1030" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(metricas_medias, <span class="st">"html"</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"AUC"</span>, <span class="st">"Precisión"</span>, <span class="st">"Recall"</span>, <span class="st">"F1-Score"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-1031"><a href="#cb1-1031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>),</span>
<span id="cb1-1032"><a href="#cb1-1032" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> F, </span>
<span id="cb1-1033"><a href="#cb1-1033" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="st">"center"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-1034"><a href="#cb1-1034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-1035"><a href="#cb1-1035" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1036"><a href="#cb1-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1037"><a href="#cb1-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1038"><a href="#cb1-1038" aria-hidden="true" tabindex="-1"></a>Como se puede observar, el AUC y el Recall son excelentes, pero no la precisión y el F1-score (fruto de la precisión). Esto se debe al gran desbalanceo de datos, que se acentúa más incluso al hacer las divisiones del cross validation, por lo que no debería ser alarmante teniendo el cuenta las condiciones.</span>
<span id="cb1-1039"><a href="#cb1-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1040"><a href="#cb1-1040" aria-hidden="true" tabindex="-1"></a>Por tanto, para la aplicación shiny se usará este modelo con las variables especificadas anteriormente, entrenado con todo el conjunto de datos.</span>
<span id="cb1-1041"><a href="#cb1-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1042"><a href="#cb1-1042" aria-hidden="true" tabindex="-1"></a><span class="fu"># Shiny APP</span></span>
<span id="cb1-1043"><a href="#cb1-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1044"><a href="#cb1-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb1-1045"><a href="#cb1-1045" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;iframe src="https://pbbldd-gonzalo-mesas0aranda.shinyapps.io/modeloFinal/" width="100%" height="500px"&gt;&lt;/iframe&gt;</span></span>
<span id="cb1-1046"><a href="#cb1-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>